!function(a){"function"==typeof define&&define.amd?define(["jquery","bs/modal"],a):a(jQuery,Modal)}(function(a,b){a.fn.wizard=function(a){return new d(this,a)},a.fn.wizard.logging=!1;var c=function(a,b,c,d,e){this.wizard=a,this.index=c,this.prev=d,this.next=e,this.el=b,this.title=b.find("h3").first().text()||"",this.name=b.data("cardname")||this.title,this.nav=this._createNavElement(this.title,c),this._disabled=!1,this._loaded=!1,this._events={}};c.prototype={select:function(){this.log("selecting"),this.isSelected()||(this.nav.addClass("active"),this.el.show(),this._loaded||(this.trigger("loaded"),this.reload()),this.trigger("selected"));var b=this.wizard;return b.backButton.toggleClass("disabled",0==this.index),b.removeSubmitButton(),this.index>=b._cards.length-1?(this.log("on last card, changing next button to submit"),b.changeNextButton(b.args.buttons.submitText,"btn-success"),b._readyToSubmit=!0,b.trigger("readySubmit")):((a.isArray(b.args.submitCards)&&(a.inArray(this.name,b.args.submitCards)>-1||a.inArray(this.index,b.args.submitCards)>-1)||(b.args.submitCards||"number"==typeof b.args.submitCards)&&(b.args.submitCards===this.name||b.args.submitCards==this.index))&&(this.log("on card "+this.name?"'"+this.name+"'":this.index+", enable submit button"),b.createSubmitButton(b.args.buttons.submitText,"btn-success")),b._readyToSubmit=!1,b.changeNextButton(b.args.buttons.nextText,"btn-primary")),this},_createNavElement:function(b,c){var d=a('<li class="wizard-nav-item"></li>'),e=a('<a class="wizard-nav-link"></a>');return e.data("navindex",c),d.append(e),e.append('<span class="glyphicon glyphicon-chevron-right"></span> '),e.append(b),d},markVisited:function(){return this.log("marking as visited"),this.nav.addClass("already-visited"),this.trigger("markVisited"),this},unmarkVisited:function(){return this.log("unmarking as visited"),this.nav.removeClass("already-visited"),this.trigger("unmarkVisited"),this},deselect:function(){return this.nav.removeClass("active"),this.el.hide(),this.trigger("deselect"),this},enable:function(){return this.log("enabling"),this.nav.addClass("active"),this._disabled=!1,this.trigger("enabled"),this},disable:function(a){return this.log("disabling"),this._disabled=!0,this.nav.removeClass("active already-visited"),a&&this.el.hide(),this.trigger("disabled"),this},isDisabled:function(){return this._disabled},alreadyVisited:function(){return this.nav.hasClass("already-visited")},isSelected:function(){return this.nav.hasClass("active")},reload:function(){return this._loaded=!0,this.trigger("reload"),this},on:function(){return this.wizard.on.apply(this,arguments)},trigger:function(){return this.callListener("on"+arguments[0]),this.wizard.trigger.apply(this,arguments)},toggleAlert:function(b,c){this.log("toggling alert to: "+c),c="undefined"==typeof c||c,c?this.trigger("showAlert"):this.trigger("hideAlert");var d,e=this.el.children("h3").first().next("div.alert");if(0==e.length){if(!c)return this;this.log("couldn't find existing alert div, creating one"),d=a("<div />"),d.addClass("alert"),d.addClass("hide"),d.insertAfter(this.el.find("h3").first())}else this.log("found existing alert div"),d=e.first();return c?(null!=b&&(this.log("setting alert msg to",b),d.html(b)),d.show()):d.hide(),this},callListener:function(a){a=a.toLowerCase(),this.log("looking for listener "+a);var b=window[this.el.data(a)];if(b){this.log("calling listener "+a);this.wizard;try{b(this)}catch(b){this.log("exception calling listener "+a+": ",b)}}else this.log("didn't find listener "+a)},problem:function(a){this.nav.find("a").toggleClass("wizard-step-error",a)},validate:function(){var b=!1,c=this.wizard;if(c.args.validate&&"object"==typeof c.args.validate&&("function"==typeof c.args.validate[this.name]||"function"==typeof c.args.validate[this.index]))return b="function"==typeof c.args.validate[this.name]?c.args.validate[this.name].call(this,this.el.find("form")):c.args.validate[this.index].call(this,this.el.find("form"));var d=this;this.el.find("[data-validate]").each(function(c,e){d.log("validating individiual inputs"),e=a(e);var f=e.data("validate");if(f){var g={status:!0,title:"Error",msg:""},h=window[f](e);if(a.extend(g,h),1===a("#btn-"+e.attr("id")).length&&(e=a("#btn-"+e.attr("id"))),g.status){e.parents("div.form-group").toggleClass("has-error",!1),1===a("#btn-"+e.attr("id")).length&&(e=a("#btn-"+e.attr("id")));try{e.popover("destroy")}catch(a){e.popover("hide")}}else b=!0,e.parents("div.form-group").toggleClass("has-error",!0),1===a("#btn-"+e.attr("id")).length&&(e=a("#btn-"+e.attr("id"))),d.wizard.errorPopover(e,g.msg)}}),this.log("after validating inputs, failures is",b);var e=window[this.el.data("validate")];if(e){this.log("running html-embedded card validator");var f=e(this);"undefined"!=typeof f&&null!=f||(f=!0),f||(b=!0),this.log("after running html-embedded card validator, failures is",b)}this.log("running listener validator");var g=this.trigger("validate");"undefined"!=typeof g&&null!=g||(g=!0),g||(b=!0),this.log("after running listener validator, failures is",b);var h=!b;return h?(this.log("validated, calling listeners"),this.trigger("validated")):(this.log("invalid"),this.trigger("invalid")),h},log:function(){if(window.console&&a.fn.wizard.logging){var b="card '"+this.name+"': ",c=[b];c.push.apply(c,arguments),console.log.apply(console,c)}},isActive:function(){return this.nav.hasClass("active")}};var d=function(b,c){this.wizard_template=['<div class="wizard-steps pull-left">','<div class="wizard-nav-container">','<ul class="nav wizard-nav-list">',"</ul>","</div>",'<div class="wizard-progress-container">','<div class="progress progress-striped">','<div class="progress-bar" style="width: 0%;"></div>',"</div>","</div>","</div>",'<div class="wizard-cards">','<div class="wizard-card-container">',"</div>",'<div class="wizard-footer">','<div class="wizard-buttons-container">','<button class="btn wizard-cancel wizard-close" type="button">Cancel</button>','<div class="btn-group-single pull-right">','<button class="btn wizard-back" type="button">Back</button>','<button class="btn btn-primary wizard-next" type="button">Next</button>',"</div>","</div>","</div>","</div>"],this.args={keyboard:!0,backdrop:!0,show:!1,animation:!0,draggable:!0,submitUrl:"",submitCards:null,validate:null,showCancel:!1,showClose:!0,progressBarCurrent:!1,increaseHeight:0,contentHeight:300,contentWidth:580,contentMaxHeight:"100%",buttons:{cancelText:"取消",nextText:"下一步",backText:"上一步",submitText:"提交",submittingText:"提交中...",validatingText:"验证信息中..."},formClass:"form-horizontal"},a.extend(this.args,c||{}),this._create(b)};d.prototype={log:function(){if(window.console&&a.fn.wizard.logging){var b="wizard "+this.modal.id+": ",c=[b];c.push.apply(c,arguments),console.log.apply(console,c)}},_create:function(c){this.element=a(c),this.title=this.element.data("title"),this.markup=this.element.children().clone(!0),this.markup_bak=this.markup.clone(!0),this.element.empty();var d=".wizard-card",e=".wizard-error,.wizard-failure,.wizard-success,.wizard-loading";this.submitCards=this.markup.filter(e),this.submitCards=this.submitCards.add(this.markup.find(e));var f=this;if(this.dialogModal=new b({type:"",title:f.title,message:this.wizard_template.join("\n"),closable:f.args.showClose,backdrop:f.args.backdrop,closeByKeyboard:f.args.keyboard,closeByBackdrop:"static"!==f.args.backdrop,cssClass:"wizard",position:"center",size:{height:this.args.contentHeight,maxHeight:this.args.contentMaxHeight,width:this.args.contentWidth},animation:f.args.animation,draggable:f.args.draggable,buttons:null,onrealized:function(){f.wizardCardContainer&&f.footer&&f.wizardCardContainer.css("bottom",f.footer.outerHeight()),f.dialogModal.setSize({height:f.dialog.outerHeight()+f.header.outerHeight()},!0),f.trigger("realized")},onshow:function(){f.trigger("show")},onshown:function(){f.trigger("shown")},onhide:function(){f.trigger("close")},onhidden:function(){f.reset(),f.element.empty().append(f.markup_bak),f.markup_bak=null,f.realized=!1,f.trigger("closed")}}),this.dialogModal.realize(),this.dialogModal.getModalContent().addClass("wizard-content"),this.dialogModal.getModalDialog().addClass("wizard-dialog"),this.dialogModal.getModalHeader().addClass("wizard-header"),this.dialogModal.getModalHeader().find(".close").addClass("wizard-close"),this.dialogModal.getModalHeader().find(".modal-title").addClass("wizard-title"),this.dialogModal.getModalHeader().append('<span class="wizard-subtitle"></span>'),this.dialogModal.getModalBody().addClass("wizard-body"),this.dialogModal.getModalFooter().hide(),this.el=this.dialogModal.getModal(),this.modal=this.el,this.content=this.modal.find(".wizard-content"),this.dialog=this.dialogModal.getModalDialog(),this.header=this.dialog.find(".wizard-header"),this.body=this.dialog.find(".wizard-body"),this.wizardSteps=this.body.find(".wizard-steps"),this.wizardCards=this.body.find(".wizard-cards"),this.wizardCardContainer=this.body.find(".wizard-card-container"),this.wizardCardContainer.append(this.markup.filter(d).add(this.markup.find(d))).append(this.submitCards),this.navContainer=this.body.find(".wizard-nav-container"),this.navList=this.body.find(".wizard-nav-list"),this.progressContainer=this.body.find(".wizard-progress-container"),this.progress=this.progressContainer.find(".progress-bar"),this.closeButton=this.content.find("button.wizard-close.close"),this.cardsContainer=this.body.find("wizard-cards-container"),this.footer=this.body.find(".wizard-footer"),this.cancelButton=this.footer.find(".wizard-cancel"),this.backButton=this.footer.find(".wizard-back"),this.nextButton=this.footer.find(".wizard-next"),this._cards=[],this.cards={},this._readyToSubmit=!1,this.percentComplete=0,this._submitting=!1,this._events={},this._firstShow=!0,this._createCards(),this.cancelButton.text(this.args.buttons.cancelText),this.backButton.text(this.args.buttons.backText),this.nextButton.text(this.args.buttons.nextText),this.form=a([]),a.each(this._cards,function(a,b){f.form?f.form=f.form.add(b.el.find("form")):f.form=b.el.find("form")}),"string"==typeof this.args.formClass)this.form.addClass(this.args.formClass);else if("object"==typeof this.args.formClass){var g;a.each(this._cards,function(a,b){g=f.args.formClass[b.name]||f.args.formClass[a]||f.args.formClass._default,g&&b.el.find("form").addClass(g)}),g=null}this.popovers=[],0!=this.title.length&&this.setTitle(this.title),this.nextButton.off("click").on("click",this,this._handleNextClick),this.backButton.off("click").on("click",this,this._handleBackClick);var h=function(){f.close()};this.closeButton.off("click").on("click",h),this.cancelButton.off("click").on("click",h),this.wizardSteps.off("click").on("click","li.already-visited a.wizard-nav-link",this,function(b){var c=parseInt(a(b.target).data("navindex"));b.data.setCard(c)}),this.on("submit",this._defaultSubmit),this.realized=!0,this.args.show&&this.show()},setTitle:function(a){return this.log("setting title to",a),this.header.find(".wizard-title").first().text(a),this},setSubtitle:function(a){return this.log("setting subtitle to",a),this.header.find(".wizard-subtitle").first().text(a),this},errorPopover:function(a,b,c){this.log("launching popover on",a),c="undefined"!=typeof c&&c;var d=a.popover({content:b,trigger:"manual",html:c,container:a.parents(".form-group")}).addClass("error-popover").popover("show").next(".popover");return a.parents(".form-group").find(".popover").addClass("error-popover"),this.popovers.push(a),d},destroyPopover:function(b){b=a(b);try{b.popover("destroy")}catch(a){b.popover("hide")}},hidePopovers:function(b){this.log("hiding all popovers");var c=this;a.each(this.popovers,function(a,b){c.destroyPopover(b)}),this.body.find(".has-error").removeClass("has-error"),this.popovers=[]},eachCard:function(b){return a.each(this._cards,b),this},getActiveCard:function(){this.log("getting active card");var b=null;return a.each(this._cards,function(a,c){if(c.isActive())return b=c,!1}),b?this.log("found active card",b):this.log("couldn't find an active card"),b},changeNextButton:function(a,b){return this.log("changing next button, text: "+a,"class: "+b),"undefined"!=typeof b&&this.nextButton.removeClass("btn-success btn-primary"),b&&this.nextButton.addClass(b),this.nextButton.text(a),this},createSubmitButton:function(b,c){if(!this.submitButton||this.submitButton.length<=0){this.log("creating submit button, text: "+b,"class: "+c);var d=a("<button/>").addClass("btn wizard-submit");b&&d.text(b),c&&d.addClass(c),this.nextButton.before(d),this.submitButton=this.nextButton.siblings(".wizard-submit:first"),this.submitButton.on("click",this,function(b){var c,d=b.data,e=d?d.getActiveCard():null;if(e&&(c=e.validate())){d._submittingCard=e;var f=function(a){a._initFormToSubmit(),a._submit()};d._isDeferred(c)?(d._validateDeferred(e,c.validatingText),function(b){a.when(c).done(function(a){b._validateResolve(),(a||"undefined"==typeof a)&&f(b)}).fail(function(){b._validateResolve()})}(d)):f(d)}e=null,d=null})}return this},removeSubmitButton:function(){return this.submitButton&&(this.submitButton.off("click"),this.submitButton.remove(),this.submitButton=null),this},hide:function(){return this.log("hiding"),this.dialogModal.close(),this},close:function(){return this.log("closing"),this.dialogModal.close(),this},show:function(a){return this.log("showing"),this.realized||this._create(this.element),this._firstShow&&(this.setCard(0),this._firstShow=!1),this.args.showCancel?this.cancelButton.show():this.cancelButton.hide(),this.args.showClose&&this.closeButton.show(),this.dialogModal.open(),this},on:function(a,b){return this.log("adding listener to event "+a),this._events[a]=b,this},trigger:function(){var b=arguments[0],c=Array.prototype.slice.call(arguments);c.shift(),c.unshift(this),this.log("firing event "+b);var d=this._events[b];void 0===d&&void 0!==this.wizard&&(d=this.wizard._events[b]);var e=null,f=this;if("function"==typeof d){this.log("found event handler, calling "+b);try{e=d.apply(this,c),"submit"===b&&this._isDeferred(e)&&a.when(e).done(function(a){a||"undefined"==typeof a?f.submitSuccess():f.submitError()}).fail(function(a,b,c){f.submitFailure()})}catch(a){this.log("event handler "+b+" had an exception")}}else this.log("couldn't find an event handler for "+b);return e},reset:function(){return this.realized&&(this.log("resetting"),this.updateProgressBar(0),this.hideSubmitCards(),this.setCard(0),this.lockCards(),this.enableNextButton(),this.showButtons(),this.hidePopovers(),this.trigger("reset")),this},_abstractIncrementStep:function(a,b){var c,d=this.getActiveCard();if(d)for(this.log("searching for valid next card");;){if(c=b(d)){if(this.log("looking at card",c.index),c.isDisabled()){this.log("card "+c.index+" is disabled/locked, continuing"),d=c;continue}return this.setCard(d.index+a)}this.log("next card is not defined, breaking");break}else this.log("current card is undefined")},incrementCard:function(){this.log("incrementing card");var a=this._abstractIncrementStep(1,function(a){return a.next});return this.trigger("incrementCard"),a},decrementCard:function(){this.log("decrementing card");var a=this._abstractIncrementStep(-1,function(a){return a.prev});return this.trigger("decrementCard"),a},setCard:function(b){this.log("setting card to "+b),this.hideSubmitCards();var c=this.getActiveCard();if(this._submitting)return this.log("we're submitting the wizard already, can't change cards"),c;var d=this._cards[b];if(d){if(d.isDisabled())return this.log("new card is currently disabled, returning"),c;var e=this;if(c){if(b>c.index){for(var f=c,g=!1;f.index!=d.index;){if(f.index!=c.index&&(f.prev.deselect(),f.prev.markVisited(),f.select()),g=f.validate(),!g)return f;if(this._isDeferred(g))return this._validateDeferred(f,g.validatingText),a.when(g).done(function(a){a||"undefined"==typeof a?(e._validateResolve(!0),e.setCard(d.index)):e._validateResolve()}).fail(function(){e._validateResolve()}),f;f=f.next}f.prev.deselect(),f.prev.markVisited()}c.deselect(),c.markVisited()}if(d.select(),this.args.progressBarCurrent)this.percentComplete=100*b/this._cards.length,this.updateProgressBar(this.percentComplete);else{var h=this.percentComplete;this.percentComplete=100*b/this._cards.length,this.percentComplete=Math.max(h,this.percentComplete),this.updateProgressBar(this.percentComplete)}return d}this.log("couldn't find card "+b)},updateProgressBar:function(a,b){this.log("updating progress to "+a+"%"),this.progress.css({width:a+"%"}),this.percentComplete=a,this.trigger("progressBar",a),"undefined"==typeof b&&(b=!0),a>=100?(this.log("progress is 100, animating progress bar"),b?this.progressContainer.find(".progress").addClass("active"):this.progressContainer.find(".progress").removeClass("active")):a<=0&&(this.log("progress is 0, disabling animation"),this.progressContainer.find(".progress").removeClass("active"))},getNextCard:function(){var a=this.getActiveCard();if(a)return a.next},lockCards:function(){return this.log("locking nav cards"),this.eachCard(function(a,b){b.unmarkVisited()}),this},disableCards:function(){return this.log("disabling all nav cards"),this.eachCard(function(a,b){b.disable()}),this},enableCards:function(){return this.log("enabling all nav cards"),this.eachCard(function(a,b){b.enable()}),this},hideCards:function(){return this.log("hiding cards"),this.eachCard(function(a,b){b.deselect()}),this.hideSubmitCards(),this},hideButtons:function(){return this.log("hiding buttons"),this.dialogModal.setClosable(!1),this.cancelButton.hide(),this.nextButton.hide(),this.backButton.hide(),this.submitButton&&this.submitButton.hide(),this},showButtons:function(){return this.log("showing buttons"),this.dialogModal.setClosable(!0),this.args.showCancel?this.cancelButton.show():this.cancelButton.hide(),this.nextButton.show(),this.backButton.show(),this.submitButton&&this.submitButton.show(),this},getCard:function(b){var c=a(b).parents(".wizard-card").first()[0];if(c){var d=null;return this.eachCard(function(a,b){return c!=b.el[0]||(d=b,!1)}),d}return null},_createCards:function(){var b=null,d=null,e=null,f=this,g=this;g.log("Creating Cards");var h=this.body.find(".wizard-cards .wizard-card");a.each(h,function(h,i){i=a(i),!i.is("form")&&i.find("form").length<=0&&i.wrapInner('<form class="wizard-form"></form>'),b=e,e=new c(f,i,h,b,d),g._cards.push(e),e.name&&(g.cards[e.name]=e),b&&(b.next=e),g.body.find(".wizard-steps .wizard-nav-list").append(e.nav)})},showSubmitCard:function(a){this.log("showing "+a+" submit card");var b=this.submitCards.filter(".wizard-"+a);return b.length?(this.hideCards(),b.show(),!0):(this.log("couldn't find submit card "+a),!1)},hideSubmitCard:function(a){this.log("hiding "+a+" submit card"),this.submitCards.filter(".wizard-"+a).hide()},hideSubmitCards:function(){var b=this;a.each(["success","error","failure","loading"],function(a,c){b.hideSubmitCard(c)})},enableNextButton:function(){return this.log("enabling next button"),this.nextButton.removeAttr("disabled"),this},disableNextButton:function(){return this.log("disabling next button"),this.nextButton.attr("disabled","disabled"),this},serializeArray:function(){var b=function(c){if(!c)return[];var d;if(c.length>1)d=[],a.each(c,function(c,e){d=d.concat(b(a(e)))});else if(c.length>0){d=c.serializeArray()||[];var e;c.find('input[disabled][data-serialize="1"]').each(function(){a(this).attr("name")&&(e={name:a(this).attr("name"),value:a(this).val()},d.push(e))}),e=null}return d};return b(this._formToSubmit||this.form)},serializeObject:function(){var b={},c=this.serializeArray();return c&&a.each(c,function(){"undefined"!=typeof this.name&&("undefined"!=typeof b[this.name]?a.isArray(b[this.name])?b[this.name].push(this.value||""):b[this.name]=[b[this.name]]:b[this.name]=this.value||"")}),c=null,b},serialize:function(){var b=function(c){if(!c)return"";var d;return c.length>1?(d="",a.each(c,function(c,e){var f=b(a(e));f&&(d+=(d.length?"&":"")+f),f=null})):c.length>0&&(d=c.serialize()||"",c.find('input[disabled][data-serialize="1"]').each(function(){var b=a(this).attr("name")+"="+a(this).val();b&&(d+=(d.length?"&":"")+b),b=null})),d};return b(this._formToSubmit||this.form)},find:function(a){return this.modal.find(a)},submitSuccess:function(){this.log("submit success"),this._submitting=!1,this.hideButtons(),this.updateProgressBar(100,!1),this.showSubmitCard("success"),this.trigger("submitSuccess")},submitFailure:function(){this.log("submit failure"),this._submitting=!1,this.showSubmitCard("failure")?(this.updateProgressBar(100,!1),this.dialogModal.setClosable(!0)):this.resetSubmitCard(),this.trigger("submitFailure")},submitError:function(){this.log("submit error"),this._submitting=!1,this.showSubmitCard("error")?(this.updateProgressBar(100,!1),this.dialogModal.setClosable(!0)):this.resetSubmitCard(),this.trigger("submitError")},resetSubmitCard:function(){this._submittingCard?(this.eachCard(function(a,b){b.enable(),b.deselect(),b._loaded?b.markVisited():b.unmarkVisited(),b.index<this.wizard._submittingCard.index?b.markVisited():b.index==this.wizard._submittingCard.index&&(b.enable(),b.el.show())}),this.showButtons(),this.dialogModal.setClosable(!0),this.changeNextButton(this.args.buttons.nextText,"btn-primary"),this.enableNextButton(),this.updateProgressBar(this._submittingCard.index/this._cards.length*100),this._submittingCard.select(),delete this._submittingCard):this.reset(),this.hideSubmitCards()},_submit:function(){this.log("submitting wizard"),this._submitting=!0,this.removeSubmitButton(),this.lockCards(),this.cancelButton.hide(),this.closeButton.hide(),this.backButton.hide(),this.dialogModal.setClosable(!1),this.showSubmitCard("loading"),this.updateProgressBar(100),this.changeNextButton(this.args.buttons.submittingText,!1),this.disableNextButton();var a=this.trigger("submit");return this.trigger("loading"),a},_initFormToSubmit:function(){this._formToSubmit=null;for(var a=this.getActiveCard(),b=0;b<=a.index;b++)this._formToSubmit?this._formToSubmit=this._formToSubmit.add(this._cards[b].el.find("form")):this._formToSubmit=this._cards[b].el.find("form")},_onNextClick:function(){this.log("handling 'next' button click");var b,c=this,d=this.getActiveCard();this._readyToSubmit&&(b=d.validate())?(this._submittingCard=d,this._isDeferred(b)?(this._validateDeferred(d,b.validatingText),a.when(b).done(function(a){c._validateResolve(),(a||"undefined"==typeof a)&&c._submit()}).fail(function(){c._validateResolve()})):this._submit()):d=this.incrementCard(),this.trigger("nextClick")},_onBackClick:function(){this.log("handling 'back' button click");this.decrementCard();this.trigger("backClick")},_handleNextClick:function(a){var b=a.data;b._onNextClick.call(b)},_handleBackClick:function(a){var b=a.data;b._onBackClick.call(b)},_isDeferred:function(a){return a&&"object"==typeof a&&"function"==typeof a.done&&"function"==typeof a.fail},_validateDeferred:function(a,b){this._validatingCard=a,this.disableCards(),this.cancelButton.hide(),this.closeButton.hide(),this.backButton.hide(),this.submitButton&&this.submitButton.hide(),this.dialogModal.setClosable(!1),b=b||this.args.buttons.validatingText,this.changeNextButton(b,!1),this.disableNextButton()},_validateResolve:function(a){this.eachCard(function(b,c){c.enable(),c.deselect(),c._loaded?c.markVisited():c.unmarkVisited(),this.wizard._validatingCard&&(c.index<this.wizard._validatingCard.index&&!c.alreadyVisited()&&c.markVisited(),c.index==(a?this.wizard._validatingCard.index+1:this.wizard._validatingCard.index)&&(c.enable(),c.el.show()))}),this._validatingCard&&delete this._validatingCard,this.showButtons(),this.dialogModal.setClosable(!0),this.changeNextButton(this.args.buttons.nextText,"btn-primary"),this.enableNextButton()},_defaultSubmit:function(b){return a.ajax({type:"POST",url:b.args.submitUrl,data:b.serialize(),dataType:"json"})}}});