!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):a(jQuery)}(function(a){var b=a.fn.wizardStep,c=function(b,d){var e;if(this.$element=a(b),this.options=a.extend(!0,{},c.DEFAULTS,d),this.options.disablePreviousStep="previous"===this.$element.attr("data-restrict")||this.options.disablePreviousStep,d&&d.formSubmitting&&a.isArray(d.formSubmitting.steps)&&(this.options.formSubmitting.steps=[].concat(d.formSubmitting.steps)),this.borderH=0,this.actionsH=0,this.stepContentDH=0,this.currentStep=this.options.stepIndex,this.numSteps=this.$element.find(".steps li").length,this.$prevBtn=this.$element.find(".btn-prev"),this.$nextBtn=this.$element.find(".btn-next"),this.$submitBtn=this.$element.find(".btn-submit"),this.$submitBtn.hide(),this.disableSubmit(),this.$element.removeClass("wizard-orient-horizontal wizard-orient-vertical").addClass("wizard-orient-"+this.options.orient),this.borderH=this.$element.outerHeight()-this.$element.innerHeight(),this.actionsH=this.$element.find(".actions").outerHeight(),"vertical"===this.options.orient){var f=this.$element.find(".step-content:first"),g=parseFloat(f.css("padding-top"))||0,h=parseFloat(f.css("padding-bottom"))||0,i=f.outerHeight()-f.innerHeight();f.css("bottom",this.actionsH),this.stepContentDH=this.actionsH+g+h+i}e=this.$nextBtn.children().detach(),this.nextText=a.trim(this.$nextBtn.text()),this.$nextBtn.append(e),this.$prevBtn.on("click.bs.wizard",a.proxy(this.previous,this)),this.$nextBtn.on("click.bs.wizard",a.proxy(this.next,this)),this.$submitBtn.on("click.bs.wizard",a.proxy(this.submit,this)),this.$element.on("click.bs.wizard","li.complete",a.proxy(this.stepclicked,this)),this.$element.on("changed.bs.wizard",a.proxy(this.changed,this)),this.selectStep(this.options.stepIndex),this.options.disablePreviousStep&&(this.$prevBtn.prop("disabled",!0),this.$element.find(".steps").addClass("previous-disabled"))};c.DEFAULTS={disablePreviousStep:!1,stepIndex:-1,height:"auto",minHeight:0,orient:"horizontal",formMode:!1,formSubmitting:{steps:[],ajaxOptions:null,validations:{},action:null,success:null,error:null},onChanged:null},c.prototype={constructor:c,destroy:function(){return this.$element.remove(),this.$element[0].outerHTML},addSteps:function(b){var c,d,e,f,g,h,i=[].slice.call(arguments).slice(1),j=this.$element.find(".steps"),k=this.$element.find(".step-content");for(b=b===-1||b>this.numSteps+1?this.numSteps+1:b,i[0]instanceof Array&&(i=i[0]),g=j.find("li:nth-child("+b+")"),f=k.find(".step-pane:nth-child("+b+")"),g.length<1&&(g=null),c=0,d=i.length;c<d;c++)h=a('<li data-step="'+b+'"><span class="badge badge-info"></span></li>'),h.append(i[c].label||"").append('<span class="chevron"></span>'),h.find(".badge").append(i[c].badge||b),i[c].name&&h.attr("data-name",i[c].name),e=a('<div class="step-pane" data-step="'+b+'"></div>'),e.append(i[c].pane||""),g?(g.before(h),f.before(e)):(j.append(h),k.append(e)),b++;this.syncSteps(),this.numSteps=j.find("li").length,this.setState()},removeSteps:function(b,c){var d,e="nextAll",f=0,g=this.$element.find(".steps"),h=this.$element.find(".step-content"),i=[];return c=void 0!==c?c:1,b>g.find("li").length?d=g.find("li:last"):(d=g.find("li:nth-child("+b+")").prev(),d.length<1&&(e="children",d=g)),d[e]().each(function(){var b=a(this),d=b.attr("data-step"),e=b.attr("data-name");if(!(f<c))return!1;var g=b.remove(),j=h.find('.step-pane[data-step="'+d+'"]:first').remove(),k=g.find(".badge").html(),l=j.html(),m="",n=!1;a.each(this.childNodes,function(b,c){if(n){if(a(c).is(".chevron"))return n=!1,!1;m+="#text"===c.nodeName?c.nodeValue:c.outerHTML}else a(c).is(".badge")&&(n=!0)}),i.push({name:e,badge:k,label:m,pane:l}),f++}),this.syncSteps(),this.numSteps=g.find("li").length,this.setState(),i},setState:function(){var b=this.currentStep>1,c=1===this.currentStep,d=this.currentStep===this.numSteps,e=this.getStep();this.options.disablePreviousStep||this.$prevBtn.prop("disabled",c===!0||b===!1),this.options.formMode&&(d||~a.inArray(this.currentStep,this.options.formSubmitting.steps)||~a.inArray(e.attr("data-name"),this.options.formSubmitting.steps)?(this.enableSubmit(),this.$submitBtn.show()):(this.$submitBtn.hide(),this.disableSubmit()),d?(this.$nextBtn.hide(),this.disableNext()):(this.enableNext(),this.$nextBtn.show()));var f=this.$nextBtn.attr("data-last");if(f){this.lastText=f;var g=this.nextText;d===!0?(g=this.lastText,this.$element.addClass("complete")):this.$element.removeClass("complete");var h=this.$nextBtn.children().detach();this.$nextBtn.text(g).append(h)}var i=this.$element.find(".steps li");i.removeClass("active").removeClass("complete"),i.find("span.badge").removeClass("badge-info").removeClass("badge-success");var j=".steps li:lt("+(this.currentStep-1)+")",k=this.$element.find(j);k.addClass("complete"),k.find("span.badge").addClass("badge-success"),e.addClass("active"),e.find("span.badge").addClass("badge-info");var l=this.$element.find(".step-content"),m=this.getStepPane();if(l.find(".step-pane").removeClass("active"),m.addClass("active"),this.$element.find(".steps").first().attr("style","margin-left: 0"),"horizontal"===this.options.orient){var n=0;this.$element.find(".steps > li").each(function(){n+=a(this).outerWidth()});var o=0;if(o=this.$element.find(".actions").length?this.$element.width()-this.$element.find(".actions").first().outerWidth():this.$element.width(),n>o){var p=n-o;this.$element.find(".steps").first().attr("style","margin-left: -"+p+"px"),this.$element.find("li.active").first().position().left<200&&(p+=this.$element.find("li.active").first().position().left-200,p<1?this.$element.find(".steps").first().attr("style","margin-left: 0"):this.$element.find(".steps").first().attr("style","margin-left: -"+p+"px"))}}if(this.updateSize(),"undefined"!=typeof this.initialized){var q=a.Event("changed.bs.wizard");this.$element.trigger(q,{step:this.currentStep,name:e.attr("data-name")})}this.initialized=!0},updateSize:function(){var a=function(a){return"number"==typeof a||/^\d+(\.\d+)?$/.test(a)};if("auto"!==this.options.height)this.$element.css("height",this.options.height+(a(this.options.height)?"px":""));else if("vertical"===this.options.orient){var b,c=this.getStepPane();b=Math.max(this.$element.find(".steps").outerHeight()+this.actionsH+this.borderH,c.outerHeight(!0)+this.stepContentDH+this.borderH),this.$element.css("height",b+"px")}if(this.options.minHeight&&this.$element.css("minHeight",this.options.minHeight+(a(this.options.minHeight)?"px":"")),"horizontal"===this.options.orient&&("auto"!==this.options.height||this.options.minHeight)){var d=this.$element.find(".step-content:first");d.css("height",this.$element.outerHeight()-this.actionsH+"px"),this.$element.css("height","auto")}},stepclicked:function(b){var c=a(b.currentTarget),d=this.$element.find(".steps li").index(c);if(!(d<this.currentStep&&this.options.disablePreviousStep)){var e=a.Event("stepclicked.bs.wizard");this.$element.trigger(e,{step:d+1}),e.isDefaultPrevented()||(this.currentStep=d+1,this.setState())}},syncSteps:function(){var b=1,c=this.$element.find(".steps"),d=this.$element.find(".step-content");c.children().each(function(){var c=a(this),e=c.find(".badge"),f=c.attr("data-step");isNaN(parseInt(e.html(),10))||e.html(b),c.attr("data-step",b),d.find('.step-pane[data-step="'+f+'"]:last').attr("data-step",b),b++})},getStep:function(a){a=a||this.currentStep;var b="number"==typeof a||/^d+$/.test(a),c=b?".steps li:eq("+(a-1)+")":'.steps li[data-name="'+a+'"]';return this.$element.find(c)},getStepPane:function(a){var b=this.getStep(a),c=b.attr("data-step");return this.$element.find('.step-content .step-pane[data-step="'+c+'"]:first')},setStepPane:function(a,b){if(a){var c=this.getStepPane(b);c.html(a),this.updateSize()}},disablePrevious:function(){this.$prevBtn.prop("disabled",!0);var a=this.$element.find(".steps li:lt("+(this.currentStep-1)+")");a.removeClass("active").removeClass("complete"),a.find("span.badge").removeClass("badge-info").removeClass("badge-success")},enablePrevious:function(){this.$prevBtn.prop("disabled",!1);var a=this.$element.find(".steps li:lt("+(this.currentStep-1)+")");a.addClass("complete"),a.find("span.badge").addClass("badge-success")},previous:function(){if(this.options.disablePreviousStep||1===this.currentStep||this.$prevBtn.prop("disabled"))return this;var b=a.Event("actionclicked.bs.wizard");if(this.$element.trigger(b,{step:this.currentStep,direction:"previous"}),!b.isDefaultPrevented()&&(this.currentStep-=1,this.setState(),this.$prevBtn.is(":focus"))){var c=this.$element.find(".active").find("input, select, textarea")[0];"undefined"!=typeof c?a(c).focus():0===this.$element.find(".active input:first").length&&this.$prevBtn.is(":disabled")&&this.$nextBtn.focus()}},disableNext:function(){this.$nextBtn.prop("disabled",!0)},enableNext:function(){this.$nextBtn.prop("disabled",!1)},next:function(){return this.$nextBtn.prop("disabled")?this:void this.validateStep(function(){if(this.currentStep<this.numSteps){var b=a.Event("actionclicked.bs.wizard");if(this.$element.trigger(b,{step:this.currentStep,direction:"next"}),b.isDefaultPrevented())return;this.currentStep+=1,this.setState()}else this.$element.trigger("finished.bs.wizard"),this.options.formMode&&this.submit();if(this.$nextBtn.is(":focus")){var c=this.$element.find(".active").find("input, select, textarea")[0];"undefined"!=typeof c?a(c).focus():0===this.$element.find(".active input:first").length&&this.$nextBtn.is(":disabled")&&this.$prevBtn.focus()}})},changed:function(a,b){"function"==typeof this.options.onChanged&&this.options.onChanged.call(this,b)},setSubmitStep:function(b,c){"undefined"==typeof c&&(c=!0);var d=this,e=!1,f=function(b){var e=a.inArray(b,d.options.formSubmitting.steps);~e&&!c?d.options.formSubmitting.steps.splice(e,1):c&&d.options.formSubmitting.steps.push(b)},g=function(a){e!==!0&&(e||d.currentStep!=a&&d.currentStep!=d.$element.find(".steps li").index(d.$element.find('.steps li[data-name="'+a+'"]'))||(e=!0))};a.isArray(b)?a.each(b,function(a,b){g(b),f(b)}):(g(b),f(b)),e&&this.currentStep!==this.numSteps&&(c?(this.enableSubmit(),this.$submitBtn.show()):(this.$submitBtn.hide(),this.disableSubmit()))},disableSubmit:function(){this.$submitBtn.prop("disabled",!0)},enableSubmit:function(){this.$submitBtn.prop("disabled",!1)},submit:function(){return!this.options.formMode||this.$submitBtn.prop("disabled")?this:void this.validateStep(function(){var b=this.options.formSubmitting;if("function"==typeof b.action)b.action.call(this);else{var c,d=this;if(c="string"==typeof b.ajaxOptions?{url:b.ajaxOptions}:a.extend({},b.ajaxOptions),c.url){if(c.data){var e;"string"==typeof c.data?(e=this.serialize(),e&&(c.data=e+"&"+c.data)):a.isArray(c.data)?(e=this.serializeArray(),e.length&&(c.data=c.data.concat(e))):(e=this.serializeObject(),c.data=a.extend({},e,c.data))}else c.data=a.extend({},this.serializeObject());"function"==typeof c.success&&(b.success=c.success,delete c.success),"function"==typeof c.error&&(b.error=c.error,delete c.error),this.disableButtons(),a.ajax(c).then(function(){d.enableButtons(),"function"==typeof b.success&&b.success.apply(d,arguments)},function(){d.enableButtons(),"function"==typeof b.error&&b.error.apply(d,arguments)})}}})},validateStep:function(b,c){var d="function"==typeof b,e="function"==typeof c;if(!this.options.formMode)return d&&b.call(this),this;var f,g=this.options.formSubmitting.validations,h=this.getStep(),i=g[h.attr("data-name")]||g[this.currentStep];return"function"==typeof i&&(f=i.call(this,this.getStepPane())),"undefined"==typeof f||f?f&&"function"==typeof f.done?(this.disableButtons(),f.done(a.proxy(function(a){"undefined"==typeof a||a?d&&b.apply(this,arguments):e&&c.apply(this,arguments)},this)).fail(a.proxy(function(){e&&c.apply(this,arguments)},this)).always(a.proxy(function(){this.enableButtons()},this))):d&&("undefined"!=typeof f?b.call(this,f):b.call(this)):e&&c.call(this,f),this},disableButtons:function(){this.disablePrevious(),this.disableNext(),this.disableSubmit()},enableButtons:function(){this.enablePrevious(),this.enableNext(),this.enableSubmit()},serializeObject:function(b){var c={},d=this.serializeArray(b);return d&&a.each(d,function(){"undefined"!=typeof this.name&&("undefined"!=typeof c[this.name]?a.isArray(c[this.name])?c[this.name].push(this.value):c[this.name]=[c[this.name]].concat(this.value):c[this.name]=this.value)}),d=null,c},serializeArray:function(b){var c=function(b){if(!b)return[];var d;if(b.length>1)d=[],a.each(b,function(b,e){d=d.concat(c(a(e)))});else if(b.length>0){d=b.serializeArray()||[];var e;b.find('input[disabled][data-serialize="1"]').each(function(){a(this).attr("name")&&(e={name:a(this).attr("name"),value:a(this).val()},d.push(e))}),e=null}return d};return c(this.getSelectedForms(b))},serialize:function(b){var c=function(b){if(!b)return"";var d;return b.length>1?(d="",a.each(b,function(b,e){var f=c(a(e));f&&(d+=(d.length?"&":"")+f),f=null})):b.length>0&&(d=b.serialize()||"",b.find('input[disabled][data-serialize="1"]').each(function(){var b=a(this).attr("name")+"="+a(this).val();b&&(d+=(d.length?"&":"")+b),b=null})),d};return c(this.getSelectedForms(b))},getSelectedForms:function(b){b=b||this.currentStep,(b<1||b>this.numSteps)&&(b=this.numSteps);for(var c,d=a([]),e=0;e<b;e++)c=this.getStepPane(e+1),d=d.add(c.find("form"));return d},selectStep:function(a){var b,c;return a?(c=a||-1,"number"==typeof c&&c>=1&&c<=this.numSteps?(this.currentStep=c,this.setState()):(c="string"==typeof c?this.$element.find('.steps li[data-name="'+c+'"]:first').attr("data-step"):this.$element.find(".steps li.active:first").attr("data-step"),isNaN(c)||(this.currentStep=parseInt(c,10),this.setState())),b=this):b={step:this.currentStep,name:this.getStep().attr("data-name")},b}},a.fn.wizardStep=function(b){var d,e=Array.prototype.slice.call(arguments,1),f=this.each(function(){var f=a(this),g=f.data("bs.wizard"),h="object"==typeof b&&b;g||f.data("bs.wizard",g=new c(this,h)),"string"==typeof b&&(d=g[b].apply(g,e))});return void 0===d?f:d},a.fn.wizardStep.Constructor=c,a.fn.wizardStep.noConflict=function(){return a.fn.wizardStep=b,this},a(document).on("mouseover.bs.wizard.data-api",'[data-toggle="wizardStep"]',function(b){var c=a(b.target).closest(".wizard-step");c.data("bs.wizard")||c.wizardStep(c.data())}),a(function(){a('[data-toggle="wizardStep"]').each(function(){var b=a(this);b.data("bs.wizard")||b.wizardStep(b.data())})})});