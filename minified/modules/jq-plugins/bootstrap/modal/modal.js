define(["jquery"],function(a){"use strict";function b(b,c){return this.each(function(){var d=a(this),e=d.data("bs.modal"),f=a.extend({},g.DEFAULTS,d.data(),"object"==typeof b&&b);e||d.data("bs.modal",e=new g(this,f)),"string"==typeof b?e[b](c):f.show&&e.show(c)})}var c=function(b){switch(typeof b){case"undefined":case"number":case"string":case"boolean":case"function":return typeof b}return b instanceof a?"jquery":Object.prototype.toString.call(b).slice(8,-1).toLowerCase()},d=function(a){return null!==a&&"object"==typeof a&&"isPrototypeOf"in a&&"object"===c(a)},e=function(a){return"string"==typeof a&&/\.(gif|png|jpg|jpeg|bmp)]$/i.test(a)},f=function(a){return!(!a||"object"!=typeof a)&&("function"==typeof a.done&&"function"==typeof a.fail&&"function"==typeof a.then&&"function"==typeof a.always)},g=function(b,c){this.options=a.extend({},g.DEFAULTS,c),this.$win=a(window),this.$body=a(document.body),this.$element=a(b),this.$dialog=this.$element.find(".modal-dialog"),this.$backdrop=null,this.isShown=null,this.originalBodyPad=null,this.scrollbarWidth=0,this.ignoreBackdropClick=!1,this.position=null,this.relatedDialog=c?c.relatedDialog||null:null,this.showDeferred=a.Deferred(),this.remote=this.remoteOptions(),this.bodyLocked=!1,this.isDispose=!1,a.isArray(this.options.position)&&(this.options.position=this.options.position.join(" ")),"string"==typeof this.options.position&&(this.options.position=a.trim(this.options.position),this.options.position=this.options.position.replace(/\s+/g," "),this.options.position=this.options.position.replace(/^(bottom|top)\s(left|right)$/,"$2 $1"),this.options.position=this.options.position.split(" ")),a.isArray(this.options.position)?0==this.options.position.length?this.options.position[0]=this.options.position[1]="center":this.options.position.length<2&&(this.options.position[1]=this.options.position[0]):this.options.position=["center","center"]};g.VERSION="3.3.4_x1",g.TRANSITION_DURATION=300,g.BACKDROP_TRANSITION_DURATION=150,g.ORIGINAL_BODY_OVERFLOW_X=a(document.body).css("overflow-x"),g.ORIGINAL_BODY_OVERFLOW_Y=a(document.body).css("overflow-y"),g.DEFAULTS={position:"center",backdrop:!0,keyboard:!0,show:!0},g.prototype.toggle=function(a){return this.isShown?this.hide():this.show(a)},g.prototype.show=function(b){var c=this,d=a.Event("show.bs.modal",{relatedTarget:b});this.$element.trigger(d),this.isShown||d.isDefaultPrevented()||(this.isShown=!0,this.checkScrollbar(),this.setScrollbar(),this.lockBody(),this.escape(),this.resize(),this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',a.proxy(this.hide,this)),this.$dialog.on("mousedown.dismiss.bs.modal",function(){c.$element.one("mouseup.dismiss.bs.modal",function(b){a(b.target).is(c.$element)&&(c.ignoreBackdropClick=!0)})}),this.backdrop(function(){var d=a.support.transition&&c.$element.hasClass("fade");c.$element.parent().length||c.$element.appendTo(c.$body),"left"===c.options.position[0]?c.$backdrop?c.$dialog.addClass("left"):c.$element.addClass("left"):("right"===c.options.position[0]||/^\s*r\d+(\.\d+)?(px|r?em|%)?\s*$/.test(c.options.position[0]))&&(c.$backdrop?c.$dialog.addClass("right"):c.$element.addClass("right")),"top"===c.options.position[0]?c.$backdrop?c.$dialog.addClass("top"):c.$element.addClass("top"):("bottom"===c.options.position[1]||/^\s*b\d+(\.\d+)?(px|r?em|%)?\s*$/.test(c.options.position[1]))&&(c.$backdrop?c.$dialog.addClass("bottom"):c.$element.addClass("bottom")),c.handleRemote(b),c.$element.show().scrollTop(0),c.adjustDialog(),c.adjustPosition(),c.$element.trigger(a.Event("realized.bs.modal")),d&&c.$element[0].offsetWidth,c.$element.attr("aria-hidden",!1),c.$backdrop?c.$element.addClass("in"):setTimeout(function(){c.$element.addClass("in")},200),c.enforceFocus();var e=function(){c.showDeferred.resolve(),c.$backdrop||(c.releaseBody(),c.resetScrollbar());var d=c.relatedDialog?c.relatedDialog.options.message:c.options.message;if(!f(d)){var e=a.Event("shown.bs.modal",{relatedTarget:b});c.$element.trigger("focus").trigger(e)}};d?c.$dialog.one("bsTransitionEnd",e).emulateTransitionEnd(g.TRANSITION_DURATION):e()}))},g.prototype.hide=function(b){if(b&&b.preventDefault(),this.isDispose=!1===b,this.relatedDialog&&(this.relatedDialog.isDispose=this.isDispose),b=a.Event("hide.bs.modal"),this.$element.trigger(b),this.isShown&&!b.isDefaultPrevented()){this.isShown=!1,this.$backdrop||(this.checkScrollbar(),this.setScrollbar(),this.lockBody()),this.escape(),this.resize(),a(document).off("focusin.bs.modal"),this.$element.removeClass("in").attr("aria-hidden",!0).off("click.dismiss.bs.modal").off("mouseup.dismiss.bs.modal"),this.$dialog.off("mousedown.dismiss.bs.modal");var c=this,d=function(){c.hideModal()};a.support.transition&&this.$element.hasClass("fade")?this.$element.one("bsTransitionEnd",d).emulateTransitionEnd(g.TRANSITION_DURATION):d()}},g.prototype.remoteOptions=function(b){b=b||this.options;var c={url:null,data:null,callback:null,promise:null,loader:{size:32,beginFrame:1,delay:150}},g=null;if(b.remote)"function"==typeof b.remote&&(b.remote=b.remote(this.relatedDialog||this)),"string"==typeof b.remote?g=a.extend({},c,{url:b.remote}):f(b.remote)?g=a.extend({},c,{promise:b.remote}):b.remote&&null!=b.remote.url&&(g=a.extend({},c,b.remote),d(b.remote.loader)&&(g.loader=a.extend({},c.loader,b.remote.loader)));else{var h=this.relatedDialog?this.relatedDialog.options.message:b.message;f(h)&&(g=a.extend({},c,{promise:h}))}if(null!=g){g.renderTo=this.$element.find(".modal-body:first"),g.renderTo.length<=0&&(g.renderTo=this.$dialog);var i;g.loader&&"string"==typeof g.loader?i=a(e(g.loader)?'<div class="loader"><img src="'+g.loader+'" alt="Loading..."/></div>':'<div class="'+g.loader+'"></div>'):(i=a('<div class="loader" data-frame="'+g.loader.beginFrame+'" data-delay="'+g.loader.delay+'"></div>').css({margin:"0 auto"}),("number"!=typeof g.loader.size||g.loader.size<=0)&&(g.loader.size=c.loader.size),i.css({fontSize:g.loader.size+"px",width:g.loader.size+"px",height:g.loader.size+"px"})),g.loader=i,g.context=this.relatedDialog||this;var j=["callback","loader","renderTo","context","promise"],k=a.extend({},g);for(var l in j){delete k[j[l]]}for(var m in g)-1==a.inArray(m,j)&&delete g[m];k.url&&(g.ajaxSettings=a.extend({},k,{async:!0,relatedContext:this,beforeSend:function(a,b){var c=b.relatedContext;try{c.remote.renderTo.empty().append(c.remote.loader),c.remote.loader.is(".loader")&&c.remote.loader.attr("data-frame")&&c.remote.loader.loader()}catch(a){}"function"==typeof c.remote.beforeSend&&c.remote.beforeSend.call(c.remote,a,b)}}))}return g},g.prototype.handleRemote=function(b){var c=this,d=function(){var d,e,g,h=arguments[0],i=[];h?a.isArray(h)?3==h.length&&h[2].always?(i.push(h[0]),d=h[1],g=h[2]):(a.each(h,function(b,c){a.isArray(c)&&3==c.length&&c[2].always?i.push(c[0]):i.push(c)}),i.length>0?(d="success",a.each(h,function(b,c){!g&&(g=[]),a.isArray(c)&&3==c.length&&c[2].always?g.push(c[2]):g.push(void 0)})):(d=arguments[1]||"error",e=arguments[0],g=arguments[2])):e=h:(d=arguments[1]||"error",e=arguments[2],g=arguments[0]);var j=this.relatedContext||c,k=i.length?i.join("<br/>"):e;j.remote&&(j.remote.resolve=function(){j.remote.loader.is(".loader")&&j.remote.loader.attr("data-frame")&&j.remote.loader.loader("destroy"),j.remote.resolve=a.noop()},j.remote.resolve(),"function"==typeof j.remote.callback&&(k=j.remote.callback.call(j.remote,i.length?i:e,d,g)),k&&(c.relatedDialog&&(k=c.relatedDialog.formatStringContent(k)),j.remote.renderTo.empty().append(k))),j.adjustPosition();var l=c.relatedDialog?c.relatedDialog.options.message:c.options.message;if(f(l)){var m=a.Event("shown.bs.modal",{relatedTarget:b});c.$element.trigger("focus").trigger(m)}var n=a.Event("loaded.bs.modal");j.$element.data("loaded.bs.modal",{remote:j.remote,response:i.length?i:e,status:d,xhr:g}).trigger(n)};this.remote&&(this.remote.promise||this.remote.ajaxSettings)&&(this.remote.renderTo.empty().append(this.remote.loader),this.remote.loader.is(".loader")&&this.remote.loader.attr("data-frame")&&this.remote.loader.loader(),this.remote.promise?a.when(this.remote.promise,this.showDeferred).always(d):this.remote.ajaxSettings&&a.when(a.ajax(this.remote.ajaxSettings),this.showDeferred).always(d))},g.prototype.enforceFocus=function(){a(document).off("focusin.bs.modal").on("focusin.bs.modal",a.proxy(function(a){this.$element[0]===a.target||this.$element.has(a.target).length||this.$element.trigger("focus")},this))},g.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keydown.dismiss.bs.modal",a.proxy(function(a){27==a.which&&this.hide()},this)):this.isShown||this.$element.off("keydown.dismiss.bs.modal")},g.prototype.resize=function(){this.isShown?a(window).on("resize.bs.modal",a.proxy(this.handleUpdate,this)):a(window).off("resize.bs.modal")},g.prototype.lockBody=function(){this.$body.addClass("modal-open"),this.$backdrop||("hidden"!==this.$body.css("overflow-y")&&this.$body.css("overflow-y","hidden"),"hidden"!==this.$body.css("overflow-x")&&this.$body.css("overflow-x","hidden")),this.bodyLocked=!0},g.prototype.releaseBody=function(){this.$body.removeClass("modal-open"),this.$backdrop||(this.$body.css("overflow-x",g.ORIGINAL_BODY_OVERFLOW_X),this.$body.css("overflow-y",g.ORIGINAL_BODY_OVERFLOW_Y)),this.bodyLocked=!1},g.prototype.hideModal=function(){var a=this;this.$element.hide(),this.backdrop(function(){a.releaseBody(),a.resetAdjustments(),a.resetScrollbar(),a.$element.trigger("hidden.bs.modal")})},g.prototype.removeBackdrop=function(){if(this.$backdrop){var a=this.$backdrop.data("in-style");a&&a.remove(),a=null,this.$backdrop.removeData("in-style"),this.$backdrop.remove()}this.$backdrop=null},g.prototype.backdrop=function(b){var c=this,d=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var e=a.support.transition&&d;if(this.$backdrop=a('<div class="modal-backdrop '+d+'" />').appendTo(this.$body),this.injectBackdropStyle(),this.$element.on("click.dismiss.bs.modal",a.proxy(function(b){if(this.ignoreBackdropClick)return void(this.ignoreBackdropClick=!1);b.target===b.currentTarget&&("static"==this.options.backdrop||a.isArray(this.options.backdrop)&&this.options.backdrop.length?this.$element[0].focus():this.hide())},this)),e&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!b)return;e?this.$backdrop.one("bsTransitionEnd",b).emulateTransitionEnd(g.BACKDROP_TRANSITION_DURATION):b()}else if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass("in");var f=function(){c.removeBackdrop(),b&&b()};a.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one("bsTransitionEnd",f).emulateTransitionEnd(g.BACKDROP_TRANSITION_DURATION):f()}else"function"==typeof b&&b()},g.prototype.injectBackdropStyle=function(){if(this.$backdrop&&a.isArray(this.options.backdrop)&&this.options.backdrop.length){this.$backdrop.css("background-color",this.options.backdrop[0]);var b;if(this.options.backdrop[1]&&!isNaN(b=parseFloat(this.options.backdrop[1]))&&b>0&&b<=1){var c=a('<style type="text/css"></style>');this.$backdrop.data("in-style",c),c.text(".modal-backdrop.in{filter:alpha(opacity="+100*b+");opacity:"+b+"}"),c.insertBefore(this.$backdrop)}}},g.prototype.handleUpdate=function(){this.adjustDialog(),this.adjustPosition()},g.prototype.adjustDialog=function(){if(this.$backdrop){var a=this.$element[0].scrollHeight>document.documentElement.clientHeight;this.$element.css({paddingLeft:!this.bodyIsOverflowing&&a?this.scrollbarWidth:"",paddingRight:this.bodyIsOverflowing&&!a?this.scrollbarWidth:""}),this.$element.removeAttr("aria-backdropedby")}else{var b=this.$dialog.outerWidth();this.$element.attr("aria-backdropedby","false").css("padding",0).width(b)}},g.prototype.adjustPosition=function(){this.relatedDialog&&this.relatedDialog.updateSize(),!this.position&&(this.position=[]);var a=this,b=this.$backdrop?this.$element.innerWidth():this.$body.innerWidth()-(this.bodyLocked?this.scrollbarWidth:0),c=this.$backdrop?this.$element.innerHeight():this.$win.height(),d=this.$dialog.outerWidth(),e=this.$dialog.outerHeight(),f=function(){var b=a.options.position[1];if("center"===b||"left"===b||"right"===b||/^r\d+(px|r?em|%)?$/i.test(b)){var d=c-e;b=d<0?0:d/3>e?(d-e)/2:d/2}else if("top"===b)b=0;else if("bottom"===b)b=c-e;else if("string"==typeof b){var f=!1;if(/^b/i.test(b)&&(f=!0,b=b.replace(/^b/i,"")),/%$/.test(b))b=c*parseFloat(b)/100;else if(/r?em$/.test(b)){var g=/rem$/.test(b)?parseInt(a.$body.css("fontSize")):parseInt(a.$dialog.css("fontSize"));isNaN(g)&&(g=14),b=g*parseFloat(b)}else/^\d+(\.\d+)?/.test(b)&&(b=parseFloat(b));f&&(b=c-e-b),isNaN(b)&&(b=0)}else"number"!=typeof b&&(b=0);return b=b<0?0:b,a.position[1]=b,0==b?0:b+"px"}(),g=function(){var c=a.options.position[0];if("center"===c||"top"===c||"bottom"===c||/^b\d+(px|r?em|%)?$/i.test(c)){if(c=(b-d)/2,a.$backdrop)return a.position[0]=c,""}else if("left"===c)c=0;else if("right"===c)c=b-d;else if("string"==typeof c){var e=!1;if(/^r/i.test(c)&&(e=!0,c=c.replace(/^r/i,"")),/%$/.test(c))c=b*parseFloat(c)/100;else if(/r?em$/.test(c)){var f=/rem$/.test(c)?parseInt(a.$body.css("fontSize")):parseInt(a.$dialog.css("fontSize"));isNaN(f)&&(f=14),c=f*parseFloat(c)}else/^\d+(\.\d+)?/.test(c)&&(c=parseFloat(c));e&&(c=b-d-c),isNaN(c)&&(c=0)}else"number"!=typeof c&&(c=0);return c=c<-d?-d:c,a.position[0]=c,0!=c&&(c+="px"),a.$backdrop?" "+c:c}();this.$backdrop?this.$dialog.css("margin",f+" auto auto"+g):(this.$dialog.css("margin",0),this.$element.css({top:f,left:g}))},g.prototype.resetAdjustments=function(){this.$element.css({paddingLeft:"",paddingRight:""})},g.prototype.checkScrollbar=function(){var a=window.innerWidth;if(!a){var b=document.documentElement.getBoundingClientRect();a=b.right-Math.abs(b.left)}this.bodyIsOverflowing=document.body.clientWidth<a,this.scrollbarWidth=this.measureScrollbar()},g.prototype.setScrollbar=function(){var a=parseInt(this.$body.css("padding-right")||0,10);this.originalBodyPad=document.body.style.paddingRight||"",this.bodyIsOverflowing&&this.$body.css("padding-right",a+this.scrollbarWidth)},g.prototype.resetScrollbar=function(){this.$body.css("padding-right",this.originalBodyPad)},g.prototype.measureScrollbar=function(){if("hidden"===g.ORIGINAL_BODY_OVERFLOW_Y)return 0;var a=document.createElement("div");a.className="modal-scrollbar-measure",this.$body.append(a);var b=a.offsetWidth-a.clientWidth;return this.$body[0].removeChild(a),b};var h=a.fn.modal;a.fn.modal=b,a.fn.modal.Constructor=g,a.fn.modal.noConflict=function(){return a.fn.modal=h,this},a(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(c){var d=a(this),e=d.attr("href"),f=a(d.attr("data-target")||e&&e.replace(/.*(?=#[^\s]+$)/,"")),g=f.data("bs.modal")?"toggle":a.extend({remote:!/#/.test(e)&&e},f.data(),d.data());d.is("a")&&c.preventDefault(),f.one("show.bs.modal",function(a){a.isDefaultPrevented()||f.one("hidden.bs.modal",function(){d.is(":visible")&&d.trigger("focus")})}),b.call(f,g,this)});var i=function(a,b){g.call(this,a,b)};i.ORIGINAL_BODY_PADDING=parseFloat(a("body").css("padding-right"))||0,i.METHODS_TO_OVERRIDE={setScrollbar:function(){var a=i.ORIGINAL_BODY_PADDING;this.bodyIsOverflowing&&this.$body.css("padding-right",a+this.scrollbarWidth)},resetScrollbar:function(){0!==this.getGlobalOpenedDialogs().length&&this.$backdrop||this.$body.css("padding-right",i.ORIGINAL_BODY_PADDING)},lockBody:function(){var b=this,c=this.getGlobalOpenedDialogs();a.each(c,function(a,c){var d=c.getModal().data("bs.modal");d&&!d.bodyLocked&&(d.bodyLocked=!0,!b.lockedDialogs&&(b.lockedDialogs=[]),b.lockedDialogs.push(c)),d=null}),this.$body.addClass("modal-open"),this.$backdrop||("hidden"!==this.$body.css("overflow-y")&&this.$body.css("overflow-y","hidden"),"hidden"!==this.$body.css("overflow-x")&&this.$body.css("overflow-x","hidden")),this.bodyLocked=!0},releaseBody:function(){this.bodyLocked=!1,this.lockedDialogs&&(a.each(this.lockedDialogs,function(a,b){var c=b.getModal().data("bs.modal");c&&(c.bodyLocked=!1)}),delete this.lockedDialogs);var b=this.getGlobalOpenedDialogs(),c=!0;if(0===b.length)this.$body.removeClass("modal-open"),c=!1;else for(var d=0;d<b.length;d++){var e=b[d],f=e.getModal().data("bs.modal");if(f.bodyLocked){c=!0;break}c=!1,f=null,e=null}c||(this.$body.css("overflow-x",g.ORIGINAL_BODY_OVERFLOW_X),this.$body.css("overflow-y",g.ORIGINAL_BODY_OVERFLOW_Y))},hideModal:function(){var a=this;this.$element.hide(),this.backdrop(function(){for(var b=a.getGlobalOpenedDialogs(),c=!1,d=0;d<b.length;d++){var e=b[d],f=e.getModal().data("bs.modal");f.$backdrop&&(c=!0),f=null,e=null}a.releaseBody(),a.resetAdjustments(),c||a.resetScrollbar(),a.$element.trigger("hidden.bs.modal")})}},i.prototype={constructor:i,getGlobalOpenedDialogs:function(){var b=[];return a.each(j.dialogs,function(a,c){c.isRealized()&&c.isOpened()&&b.push(c)}),b},setPosition:function(a,b){!this.options.position&&(this.options.position=[]),void 0!==a&&null!==a&&(this.options.position[0]=a),void 0!==b&&null!==b&&(this.options.position[1]=b),this.adjustPosition()},getPosition:function(){return this.position}},i.prototype=a.extend(i.prototype,g.prototype,i.METHODS_TO_OVERRIDE);var j=function(b){this.defaultOptions=a.extend(!0,{id:j.newGuid(),buttons:[],data:{},onshow:null,onshown:null,onhide:null,onhidden:null,onloaded:null},j.defaultOptions),this.indexedButtons={},this.registeredButtonHotkeys={},this.draggableData={isMouseDown:!1,mouseOffset:{}},this.realized=!1,this.opened=!1,this.isDispose=!1,this.initOptions(b),this.holdThisInstance()};return j.Modal=i,j.NAMESPACE="dialog-modal",j.TYPE_DEFAULT="type-default",j.TYPE_INFO="type-info",j.TYPE_PRIMARY="type-primary",j.TYPE_SUCCESS="type-success",j.TYPE_WARNING="type-warning",j.TYPE_ERROR="type-error",j.TYPE_LOADING="type-loading",j.TYPE_NOTE="type-note",j.TYPE_NOTE_PROCESSING=j.TYPE_NOTE+"-processing",j.TYPE_NOTE_INFO=j.TYPE_NOTE+"-info",j.TYPE_NOTE_WARNING=j.TYPE_NOTE+"-warning",j.TYPE_NOTE_ERROR=j.TYPE_NOTE+"-error",j.TYPE_NOTE_SUCCESS=j.TYPE_NOTE+"-success",j.DEFAULT_TEXTS={},j.DEFAULT_TEXTS[j.TYPE_DEFAULT]="Information",j.DEFAULT_TEXTS[j.TYPE_INFO]="Information",j.DEFAULT_TEXTS[j.TYPE_PRIMARY]="Information",j.DEFAULT_TEXTS[j.TYPE_SUCCESS]="Success",j.DEFAULT_TEXTS[j.TYPE_WARNING]="Warning",j.DEFAULT_TEXTS[j.TYPE_ERROR]="Error",j.DEFAULT_TEXTS.OK="确定",j.DEFAULT_TEXTS.CANCEL="取消",j.DEFAULT_TEXTS.CONFIRM="Confirmation",j.SIZE_NORMAL="size-normal",j.SIZE_SMALL="size-small",j.SIZE_WIDE="size-wide",j.SIZE_LARGE="size-large",j.BUTTON_SIZES={},j.BUTTON_SIZES[j.SIZE_NORMAL]="",j.BUTTON_SIZES[j.SIZE_SMALL]="",j.BUTTON_SIZES[j.SIZE_WIDE]="",j.BUTTON_SIZES[j.SIZE_LARGE]="btn-lg",j.ICON_SPINNER="glyphicon glyphicon-asterisk",j.defaultOptions={backdrop:"static",position:"center",type:j.TYPE_PRIMARY,size:j.SIZE_NORMAL,cssClass:"",defdom:!0,title:null,message:null,nl2br:!1,closable:!0,closeByBackdrop:!0,closeByKeyboard:!0,spinicon:j.ICON_SPINNER,autodestroy:!0,draggable:!1,animate:!0,description:""},j.configDefaultOptions=function(b){if(arguments.length>1){var c=arguments[0];b=arguments[1];var d=function(a){a&&j[a]&&"function"==typeof j[a].configDefaultOptions&&j[a].configDefaultOptions.call(j[a],b)};"string"==typeof c?d(c):a.isArray(c)&&a.each(c,function(a,b){d(b)})}else j.defaultOptions=a.extend(!0,j.defaultOptions,b)},j.dialogs={},j.openAll=function(){a.each(j.dialogs,function(a,b){b.open()})},j.closeAll=function(){a.each(j.dialogs,function(a,b){b.close()})},j.moveFocus=function(){var b=null;a.each(j.dialogs,function(a,c){b=c}),null!==b&&b.isRealized()&&b.getModal().focus()},j.prototype={constructor:j,initOptions:function(b){return this.options=a.extend(!0,this.defaultOptions,b),this},holdThisInstance:function(){return j.dialogs[this.getId()]=this,this},initModalStuff:function(){return this.setModal(this.createModal()).setModalDialog(this.createModalDialog()),this.getModal().append(this.getModalDialog()),this.options.defdom&&(this.setModalContent(this.createModalContent()).setModalHeader(this.createModalHeader()).setModalBody(this.createModalBody()).setModalFooter(this.createModalFooter()),this.getModalDialog().append(this.getModalContent()),this.getModalContent().append(this.getModalHeader()).append(this.getModalBody()).append(this.getModalFooter())),this},createModal:function(){var b=a('<div class="modal" tabindex="-1" role="dialog" aria-hidden="true"></div>');return b.prop("id",this.getId()).attr("aria-labelledby",this.getId()+"_title"),b},getModal:function(){return this.$modal},setModal:function(a){return this.$modal=a,this},createModalDialog:function(){return a('<div class="modal-dialog"></div>')},getModalDialog:function(){return this.$modalDialog},setModalDialog:function(a){return this.$modalDialog=a,this},createModalContent:function(){return a('<div class="modal-content"></div>')},getModalContent:function(){return this.$modalContent},setModalContent:function(a){return this.$modalContent=a,this},createModalHeader:function(){return a('<div class="modal-header"></div>')},getModalHeader:function(){return this.$modalHeader},setModalHeader:function(a){return this.$modalHeader=a,this},createModalBody:function(){return a('<div class="modal-body"></div>')},getModalBody:function(){return this.$modalBody},setModalBody:function(a){return this.$modalBody=a,this},createModalFooter:function(){return a('<div class="modal-footer"></div>')},getModalFooter:function(){return this.$modalFooter},setModalFooter:function(a){return this.$modalFooter=a,this},createDynamicContent:function(a){var b=null;return b="function"==typeof a?a.call(a,this):a,"string"==typeof b&&(b=this.formatStringContent(b)),b},formatStringContent:function(a){return this.options.nl2br?a.replace(/\r\n/g,"<br />").replace(/[\r\n]/g,"<br />"):a},setData:function(a,b){return this.options.data[a]=b,this},getData:function(a){return this.options.data[a]},setId:function(a){return this.options.id=a,this},getId:function(){return this.options.id},getType:function(){return this.options.type},setType:function(a){return this.options.type=a,this.updateType(),this},updateType:function(){if(this.isRealized()){var a=[j.TYPE_DEFAULT,j.TYPE_INFO,j.TYPE_PRIMARY,j.TYPE_SUCCESS,j.TYPE_WARNING,j.TYPE_ERROR];this.getModal().removeClass(a.join(" ")).addClass(this.getType())}return this},testType:function(a){var b=this.getType()||"";return!!a&&(b==a||0==b.indexOf(a+"-"))},getSize:function(){return this.options.size},setSize:function(a,b){if(this.options.size=a,this.updateSize(),b){var c=this.getModal().data("bs.modal");c&&c.adjustPosition()}return this},updateSize:function(){if(this.isRealized()){var b=this,c=[j.SIZE_NORMAL,j.SIZE_SMALL,j.SIZE_WIDE,j.SIZE_LARGE],e={width:d(j.defaultOptions.size)?j.SIZE_NORMAL:j.defaultOptions.size,minWidth:"none",maxWidth:"100%",height:"auto",minHeight:"none",maxHeight:"none"},f=this.getSize(),g=this.getModal().data("bs.modal"),h=function(b){if(void 0!==b){if("string"==typeof b&&(b=a.trim(b)),"number"==typeof b||/^\d+(\.\d+)?$/.test(b))return b+"px";if("string"==typeof b){if(/^\d+(\.\d+)?((px)|(r?em)|%)$/.test(b))return b;if(/^\d/.test(b)&&(b=parseInt(b),!isNaN(b)))return b+"px"}}return null},i=function(a){if(null!==(a=h(a))&&/%$/.test(a))if(a=parseFloat(a),isNaN(a))a=null;else{var b=g.$backdrop?g.$element.innerWidth():g.$body.innerWidth();a=b*a/100+"px"}return a},k=function(a){if(null!==(a=h(a)))if(/r?em$/.test(a)){var c=/rem$/.test(a)?parseInt(g.$body.css("fontSize")):parseInt(b.getModalDialog().css("fontSize"));isNaN(c)&&(c=14),a=c*parseFloat(a)}else if(/%$/.test(a)){var d=g.$win.height();a=parseFloat(a),a=isNaN(a)?null:d*a/100}else a=parseFloat(a),isNaN(a)&&(a=null);return a},l=function(){var a=b.getModalDialog().attr("style");a&&(a=a.replace(/\s*width\s*\:[^;]+;?$/,""),a=a.replace(/\s*width\s*\:[^;]+;\s*/," "),b.getModalDialog().attr("style",a))};if(!f||"string"!=typeof f&&"number"!=typeof f){if(f&&d(f)){f=a.extend({},e,f);var m=i(f.width),n=i(f.maxWidth),o=i(f.minWidth),p=k(f.height),q=k(f.minHeight),r=k(f.maxHeight);null!==m?this.getModalDialog().css("width",m):"auto"===f.width&&(l(),this.getModalDialog().removeClass("modal-sm modal-lg"),this.getModal().addClass("modal-auto")),null!==o?this.getModalDialog().css("minWidth",o):this.getModalDialog().css("minWidth","none"),null!==n?this.getModalDialog().css("maxWidth",n):this.getModalDialog().css("maxWidth","none");var s=this.getModalContent()||this.getModalDialog(),t=this.getModalBody()||this.getModalDialog(),u=this.getModalHeader()&&this.getModalHeader().is(":visible")?this.getModalHeader().outerHeight():0,v=this.getModalFooter()&&this.getModalFooter().is(":visible")?this.getModalFooter().outerHeight():0,w=s?s.outerHeight()-s.height():0;if(w+=u+v,null!==p||null!==q||null!==r){t.css("overflow-y","auto");var x=function(a){return a-=w,a<=0?1:a};null!==p&&t.css("height",x(p)+"px"),null!==q&&t.css("minHeight",x(q)+"px"),null!==r&&t.css("maxHeight",x(r)+"px")}else t.css("height","auto"),t.css("minHeight","none"),t.css("maxHeight","none")}}else{this.getModal().removeClass("modal-auto");var y=i(h(f));y?this.getModalDialog().css("width",y):"string"==typeof f&&(l(),this.getModal().removeClass(c.join(" ")).addClass("auto"===f?"modal-auto":f)),this.getModalDialog().removeClass("modal-sm"),f===j.SIZE_SMALL&&this.getModalDialog().addClass("modal-sm"),this.getModalDialog().removeClass("modal-lg"),f===j.SIZE_WIDE&&this.getModalDialog().addClass("modal-lg")}a.each(this.options.buttons,function(c,d){var e=b.getButton(d.id),f=["btn-lg","btn-sm","btn-xs"],g=!1;if("string"==typeof d.cssClass){var h=d.cssClass.split(" ");a.each(h,function(b,c){-1!==a.inArray(c,f)&&(g=!0)})}g||(e.removeClass(f.join(" ")),e.addClass(b.getButtonSize()))})}return this},getCssClass:function(){return this.options.cssClass},setCssClass:function(a){return this.options.cssClass=a,this},getTitle:function(){return this.options.title},setTitle:function(a){return this.options.title=a,this.updateTitle(),this},updateTitle:function(){if(this.isRealized()&&this.getModalHeader()){var a=null!==this.getTitle()?this.createDynamicContent(this.getTitle()):this.getDefaultText();this.getModalHeader().find(".modal-title").html("").append(a).prop("id",this.getId()+"_title")}return this},getMessage:function(){return this.options.message},setMessage:function(a){this.options.message=a,this.updateMessage();var b=this.getModal().data("bs.modal");return b&&b.adjustPosition.apply(b,arguments),this},updateMessage:function(){if(this.isRealized()){var a=this.createDynamicContent(this.getMessage());this.getModalBody()?this.getModalBody().html("").append(a):this.getModalDialog().html("").append(a)}return this},setPosition:function(a,b){var c=this.getModal().data("bs.modal");c&&c.setPosition.apply(c,arguments)},getPosition:function(){var a=this.getModal().data("bs.modal");return a?a.getPosition.apply(a,arguments):null},isClosable:function(){return this.options.closable},setClosable:function(a){return this.options.closable=a,this.updateClosable(),this},setCloseByBackdrop:function(a){return this.options.closeByBackdrop=a,this},canCloseByBackdrop:function(){return this.options.closeByBackdrop},setCloseByKeyboard:function(a){return this.options.closeByKeyboard=a,this},canCloseByKeyboard:function(){return this.options.closeByKeyboard},isAnimate:function(){return this.options.animate},setAnimate:function(a){return this.options.animate=a,this},updateAnimate:function(){return this.isRealized()&&this.getModal().toggleClass("fade",this.isAnimate()),this},getSpinicon:function(){return this.options.spinicon},setSpinicon:function(a){return this.options.spinicon=a,this},addButton:function(a){return this.options.buttons.push(a),this},addButtons:function(b){var c=this;return a.each(b,function(a,b){c.addButton(b)}),this},getButtons:function(){return this.options.buttons},setButtons:function(a){return this.options.buttons=a,this.updateButtons(),this},getButton:function(a){return void 0!==this.indexedButtons[a]?this.indexedButtons[a]:null},getButtonSize:function(){return void 0!==j.BUTTON_SIZES[this.getSize()]?j.BUTTON_SIZES[this.getSize()]:""},updateButtons:function(){return this.isRealized()&&this.getModalFooter()&&(0===this.getButtons().length?this.getModalFooter().hide():this.getModalFooter().show().html("").append(this.createFooterButtons())),this},isAutodestroy:function(){return this.options.autodestroy},setAutodestroy:function(a){this.options.autodestroy=a},getDescription:function(){return this.options.description},setDescription:function(a){return this.options.description=a,this},getDefaultText:function(){return j.DEFAULT_TEXTS[this.getType()]},getNamespace:function(a){return j.NAMESPACE+"-"+a},createHeaderContent:function(){var a=this.getModalHeader();return a&&(a.html(""),a.append(this.createTitleContent()),a.prepend(this.createCloseButton())),a},createTitleContent:function(){return a('<h4 class="modal-title"></h4>')},createCloseButton:function(){var b=a('<button class="close" aria-label="Close" type="button">&times;</button>');return b.on("click",{dialog:this},function(a){a.data.dialog.close()}),b},createFooterContent:function(){var a=this.getModalFooter();return a&&a.html("").append(this.createFooterButtons()),a},createFooterButtons:function(){var b=this,c=a("<div></div>");return c.addClass(this.getNamespace("footer-buttons")),this.indexedButtons={},this.options.buttons=this.options.buttons||[],a.each(this.options.buttons,function(a,d){d.id||(d.id=j.newGuid());var e=b.createButton(d);b.indexedButtons[d.id]=e,c.append(e)}),c},createButton:function(b){var c=a('<button class="btn"></button>');return c.prop("id",b.id),c.data("button",b),void 0!==b.icon&&""!==a.trim(b.icon)&&c.append(this.createButtonIcon(b.icon)),void 0!==b.label&&c.append(b.label),void 0!==b.cssClass&&""!==a.trim(b.cssClass)?c.addClass(b.cssClass):c.addClass("btn-default"),void 0!==b.hotkey&&(this.registeredButtonHotkeys[b.hotkey]=c),c.on("click",{dialog:this,$button:c,button:b},function(a){var b=a.data.dialog,c=a.data.$button,d=c.data("button");"function"==typeof d.action&&d.action.call(c,b,a),d.autospin&&c.toggleSpin(!0)}),this.enhanceButton(c),c},enhanceButton:function(a){return a.dialog=this,a.toggleEnable=function(a){var b=this;return void 0!==a?b.prop("disabled",!a).toggleClass("disabled",!a):b.prop("disabled",!b.prop("disabled")),b},a.enable=function(){var a=this;return a.toggleEnable(!0),a},a.disable=function(){var a=this;return a.toggleEnable(!1),a},a.toggleSpin=function(b){var c=this,d=c.dialog,e=c.find("."+d.getNamespace("button-icon"));return void 0===b&&(b=!(a.find(".icon-spin").length>0)),b?(e.hide(),a.prepend(d.createButtonIcon(d.getSpinicon()).addClass("icon-spin"))):(e.show(),a.find(".icon-spin").remove()),c},a.spin=function(){var a=this;return a.toggleSpin(!0),a},a.stopSpin=function(){var a=this;return a.toggleSpin(!1),a},this},createButtonIcon:function(b){var c=a("<i></i>");return c.addClass(this.getNamespace("button-icon")).addClass(b),c},enableButtons:function(b){return a.each(this.indexedButtons,function(a,c){c.toggleEnable(b)}),this},updateClosable:function(){return this.isRealized()&&this.getModalHeader()&&this.getModalHeader().find("button.close").toggle(this.isClosable()),this},onShow:function(a){return this.options.onshow=a,this},onShown:function(a){return this.options.onshown=a,this},onHide:function(a){return this.options.onhide=a,this},onHidden:function(a){return this.options.onhidden=a,this},isRealized:function(){return this.realized},setRealized:function(a){return this.realized=a,this},isOpened:function(){return this.opened},setOpened:function(a){return this.opened=a,this},handleModalEvents:function(){return this.getModal().on("realized.bs.modal",{dialog:this},function(a){var b=a.data.dialog;b.isModalEvent(a)&&"function"==typeof b.options.onrealized&&b.options.onrealized(b)}),this.getModal().on("show.bs.modal",{dialog:this},function(a){var b=a.data.dialog;if(b.setOpened(!0),b.isModalEvent(a)&&"function"==typeof b.options.onshow){var c=b.options.onshow(b);return!1===c&&b.setOpened(!1),c}}),this.getModal().on("shown.bs.modal",{dialog:this},function(a){var b=a.data.dialog
;b.isModalEvent(a)&&"function"==typeof b.options.onshown&&b.options.onshown(b)}),this.getModal().on("hide.bs.modal",{dialog:this},function(a){var b=a.data.dialog;if(b.setOpened(!1),b.isDispose&&b.testType(j.TYPE_NOTE)&&b.getModal().removeClass("right left top bottom").addClass("closing"),!b.isDispose&&b.isModalEvent(a)&&"function"==typeof b.options.onhide){var c=b.options.onhide(b);return!1===c&&b.setOpened(!0),c}}),this.getModal().on("hidden.bs.modal",{dialog:this},function(b){var c=b.data.dialog;c.isAutodestroy()&&(c.setRealized(!1),delete j.dialogs[c.getId()],a(this).remove()),j.moveFocus(),c.isDispose&&c.testType(j.TYPE_NOTE)&&(j.notes.remove(c),c.getModal().removeClass("closing")),!c.isDispose&&c.isModalEvent(b)&&"function"==typeof c.options.onhidden&&c.options.onhidden(c)}),this.getModal().on("loaded.bs.modal",{dialog:this},function(b){var c=b.data.dialog,d=a(this).data("loaded.bs.modal");c.isModalEvent(b)&&"function"==typeof c.options.onloaded&&c.options.onloaded.call(d,c),d.remote&&"function"==typeof d.remote.resolve&&d.remote.resolve()}),this.handleModalBackdropEvent(),this.getModal().on("keyup",{dialog:this},function(a){27===a.which&&a.data.dialog.isClosable()&&a.data.dialog.canCloseByKeyboard()&&a.data.dialog.close()}),this.getModal().on("keyup",{dialog:this},function(b){var c=b.data.dialog;if(void 0!==c.registeredButtonHotkeys[b.which]){var d=a(c.registeredButtonHotkeys[b.which]);!d.prop("disabled")&&d.focus().trigger("click")}}),this},handleModalBackdropEvent:function(){return this.getModal().on("click",{dialog:this},function(a){a.target===this&&a.data.dialog.isClosable()&&a.data.dialog.canCloseByBackdrop()&&a.data.dialog.close()}),this},isModalEvent:function(a){return void 0!==a.namespace&&"bs.modal"===a.namespace},makeModalDraggable:function(){return this.options.draggable&&this.getModalHeader()&&(this.getModalHeader().addClass("draggable").on("mousedown",{dialog:this},function(a){var b=a.data.dialog;b.draggableData.isMouseDown=!0,b.getModalHeader().addClass("mousedown");var c=b.getModalDialog().offset();b.draggableData.mouseOffset={top:a.clientY-c.top,left:a.clientX-c.left}}),this.getModal().on("mouseup mouseleave",{dialog:this},function(a){var b=a.data.dialog;b.getModalHeader().removeClass("mousedown"),b.draggableData.isMouseDown=!1}),a("body").on("mousemove",{dialog:this},function(a){var b=a.data.dialog;if(b.draggableData.isMouseDown){(b.getModal().data("bs.modal").$backdrop?b.getModalDialog():b.getModal()).offset({top:a.clientY-b.draggableData.mouseOffset.top,left:a.clientX-b.draggableData.mouseOffset.left})}})),this},realize:function(){return this.initModalStuff(),this.getModal().addClass(j.NAMESPACE).addClass(this.getCssClass()),this.getDescription()&&this.getModal().attr("aria-describedby",this.getDescription()),this.createFooterContent(),this.createHeaderContent(),this.getModal().data("bs.modal",new i(this.getModal(),{relatedDialog:this,backdrop:this.options.backdrop,position:this.options.position,remote:this.options.remote,keyboard:!1,show:!1})),this.makeModalDraggable(),this.handleModalEvents(),this.setRealized(!0),this.updateButtons(),this.updateType(),this.updateTitle(),this.updateMessage(),this.updateClosable(),this.updateAnimate(),this.updateSize(),this},updateBackdrop:function(){var a=this.getModal(),b=a.data("bs.modal").$backdrop;if(b){var c=this.getId()+"_backdrop";b.attr("aria-backdropedby",c);var d=b.data("in-style");d&&d.text()&&d.text(d.text().replace(/.modal-backdrop/g,'.modal-backdrop[aria-backdropedby="'+c+'"]'))}},updateZIndex:function(){var b=1040,c=1050,d=0;a.each(j.dialogs,function(a,b){d++});var e=this.getModal(),f=e.data("bs.modal").$backdrop;return e.css("z-index",c+20*(d-1)),f&&f.css("z-index",b+20*(d-1)),this},open:function(){return!this.isRealized()&&this.realize(),this.getModal().modal("show"),this.updateBackdrop(),this.updateZIndex(),this},close:function(){return this.getModal().modal("hide"),this},dispose:function(){return this.getModal().modal("hide",!1),this}},j.newGuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0;return("x"===a?b:3&b|8).toString(16)})},j.show=function(a){return new j(a).open()},j.alert=function(){var b={},c=j.alert.defaultOptions;return b="object"==typeof arguments[0]&&arguments[0].constructor==={}.constructor?a.extend(!0,{},c,arguments[0]):a.extend(!0,{},c,{message:arguments[0],callback:void 0!==arguments[1]?arguments[1]:null}),new j({type:b.type,title:b.title,cssClass:"type-alert",message:(b.icon?'<i class="modal-icon-alert'+("string"==typeof b.icon?b.icon:"")+'"></i>':"")+(b.message||""),closable:b.closable,draggable:b.draggable,closeByBackdrop:!1,closeByKeyboard:!1,data:{callback:b.callback},onhide:function(a){!a.getData("btnClicked")&&a.isClosable()&&"function"==typeof a.getData("callback")&&a.getData("callback")(!1)},buttons:[{cssClass:"btn-primary",label:b.buttonLabel,action:function(a){a.setData("btnClicked",!0),"function"==typeof a.getData("callback")&&a.getData("callback")(!0),a.close()}}]}).open()},j.alert.defaultOptions={type:j.TYPE_PRIMARY,title:"警告提示",icon:!0,message:null,closable:!0,draggable:!1,buttonLabel:j.DEFAULT_TEXTS.OK,callback:null},j.alert.configDefaultOptions=function(b){j.alert.defaultOptions=a.extend({},j.alert.defaultOptions,b)},j.confirm=function(){var b={},c=j.confirm.defaultOptions;return b="object"==typeof arguments[0]&&arguments[0].constructor==={}.constructor?a.extend(!0,{},c,arguments[0]):a.extend(!0,{},c,{message:arguments[0],buttonLabel:j.DEFAULT_TEXTS.OK,callback:void 0!==arguments[1]?arguments[1]:null}),null===b.btnOKClass&&(b.btnOKClass=["btn",b.type.split("-")[1]].join("-")),new j({type:b.type,title:b.title,cssClass:"type-confirm",message:(b.icon?'<i class="modal-icon-confirm'+("string"==typeof b.icon?b.icon:"")+'"></i>':"")+(b.message||""),closable:b.closable,draggable:b.draggable,closeByBackdrop:!1,closeByKeyboard:!1,data:{callback:b.callback},onhide:function(a){if(!a.getData("btnClicked")&&a.isClosable()){var b=a.getData("callback");"function"==typeof b&&b.call(a,!1)}},buttons:[{label:b.btnCancelLabel,action:function(a){a.setData("btnClicked",!0);try{var b=a.getData("callback");"function"==typeof b&&b.call(a,!1)}catch(a){}a.close()}},{label:b.btnOKLabel,cssClass:b.btnOKClass,action:function(a){a.setData("btnClicked",!0);try{var b=a.getData("callback");"function"==typeof b&&b.call(a,!0)}catch(a){}a.close()}}]}).open()},j.confirm.defaultOptions={type:j.TYPE_PRIMARY,title:"确认提示",icon:!0,message:null,closable:!0,draggable:!1,btnCancelLabel:j.DEFAULT_TEXTS.CANCEL,btnOKLabel:j.DEFAULT_TEXTS.OK,btnOKClass:null,callback:null},j.confirm.configDefaultOptions=function(b){j.confirm.defaultOptions=a.extend({},j.confirm.defaultOptions,b)},j.loading=function(b,c){if(j.loading.instance||"remove"===b){if("string"==typeof arguments[0]&&"remove"===arguments[0]){var d=(new Date).getTime();j.loading.timeout=j.loading.timeout||d,j.loading.stime=j.loading.stime||d;var f=j.loading.timeout-(d-j.loading.stime);delete j.loading.timeout,delete j.loading.stime;var g=function(){j.loading.instance&&(j.loading.instance.close(),delete j.loading.instance)};f>0?window.setTimeout(g,f):g()}}else{var h={},i=j.loading.defaultOptions;"object"==typeof b&&b.constructor==={}.constructor?(h=a.extend({},i,b),"number"!=typeof b.size?h.size=i.size:h.size<12&&(h.size=12)):"string"==typeof b?h=a.extend({},i,{message:b}):(h=a.extend({},i),"function"==typeof b&&(c=b)),a.extend(h,"function"==typeof c?{onhidden:c}:{}),j.loading.timeout=h.minin,j.loading.instance=new j({backdrop:["#aaa",.3],size:"100%",message:function(){return(h.loader?e(h.loader)?'<div class="loader"><img src="'+h.loader+'" alt="Loading..."/></div>':'<div class="'+h.loader+'"></div>':'<div class="loader" data-frame="'+h.beginFrame+'" data-delay="'+h.delay+'"></div>')+(h.message?'<p class="loader-text">'+h.message+"</p>":"")}(),defdom:!1,closable:!1,animate:!1,onshow:function(a){var b=a.getModalDialog();b.css({"text-align":"center",background:"none",border:"0 none","box-shadow":"none"});var c=!h.loader||e(h.loader)?b.find(".loader:first"):b.find(h.loader.replace(/\s/g,"")+":first");c.css({margin:"0 auto",fontSize:h.size+"px",width:h.size+"px",height:h.size+"px"}),!h.loader&&c.is(".loader")&&c.attr("data-frame")&&c.loader(),"function"==typeof h.onshow&&h.onshow(a)},onhidden:h.onhidden}),j.loading.instance.realize(),j.loading.instance.open(),j.loading.stime=(new Date).getTime()}return j.loading.instance},j.loading.defaultOptions={message:"",size:32,minin:300,loader:null,beginFrame:1,delay:150,onshow:null,onhidden:null},j.loading.configDefaultOptions=function(b){j.loading.defaultOptions=a.extend({},j.loading.defaultOptions,b)},j.notes={},j.notes.list=[],j.notes.remove=function(b){if(b){var c,d=[],e=0;a.each(j.notes.list,function(a,f){f.getId()===b.getId()?(c=a,e=-(b.getModal().outerHeight()+3)):d.push(f)}),j.notes.list=d;var f,g=0;a.each(j.notes.list,function(a,b){void 0!==c&&a>=c&&(f=b.getPosition(),g=f?f[1]:0,b.setPosition(null,g+e))})}},j.notes.push=function(b){j.notes.list.unshift(b);var c,d=0,e=0;a.each(j.notes.list,function(a,b){c=b.getPosition(),e=c?c[1]:0,b.setPosition(null,e+d),d=b.getModal().outerHeight()+3})},j.processing=function(b,c){var d={},f=j.processing.defaultOptions;return d="object"==typeof b&&b.constructor==={}.constructor?a.extend(!0,{},f,b):"string"==typeof b?a.extend(!0,{},f,{message:b}):a.extend({},f),a.extend(d,"function"==typeof c?{onhidden:c}:{}),new function(b,c,d){this.dialog=b,this.timeout=c||f.timeout,this.icons=a.extend({},f,d),this.warning=function(a){this.timeout=this.timeout.warning||this.timeout.default,this._update("warning",a)},this.error=function(a){this.timeout=this.timeout.error||this.timeout.default,this._update("error",a)},this.success=function(a){this.timeout=this.timeout.success||this.timeout.default,this._update("success",a)},this.open=function(){return this.dialog&&"function"==typeof this.dialog.open&&this.dialog.open(),this},this.close=function(){this.dialog&&"function"==typeof this.dialog.close&&this.dialog.close()},this._update=function(a,b){this.dialog&&(this.dialog.setMessage(this._createMessageContent(a,b)),this.dialog.updateMessage()),this._bindCloseEvent(),this._bindTimeout()},this._createMessageContent=function(a,b){return'<div class="alert alert-'+("error"===a?"danger":a)+'" role="alert"><button type="button" class="close" aria-label="Close">&times;</button><i class="'+(this.icons[a]||"")+'"></i><p>'+b+"</p></div>"},this._bindCloseEvent=function(){if(this.dialog){this.dialog.getModalDialog().find('[role="alert"]').find("button.close").one("click",this,function(a){a.data.close()})}},this._bindTimeout=function(){if(this.dialog&&this.timeout>0){var a,b=this.dialog.getModalDialog(),c=this,d=function(){a&&clearTimeout(a),a=null},e=function(){d(),a=setTimeout(function(){c.close()},c.timeout)};e(),b.on("mouseenter",{call:d},function(a){a.data.call()}).on("mouseleave",{call:e},function(a){a.data.call()})}}}(new j({type:j.TYPE_NOTE_PROCESSING,size:d.size,backdrop:d.backdrop,position:d.position,nl2br:d.nl2br,message:function(){return'<div class="alert alert-info" role="alert"><button type="button" class="close" aria-label="Close">&times;</button><i class="'+(!d.icons.processing||e(d.icons.processing)?"loader":d.icons.processing)+'">'+(e(d.icons.processing)?'<img src="'+d.icons.processing+'" alt="Processing..."/>':"")+"</i><p>"+d.message+"</p></div>"}(),defdom:!1,closeByBackdrop:!1,closeByKeyboard:!1,onrealized:function(a){j.notes.push(a)},onshow:function(a){var b=a.getModalDialog().find('[role="alert"]');b.find("i:first").css({width:"14px",height:"14px",fontSize:"14px"}),!d.icons.processing&&b.find("i:first").loader(),b.find("button.close").one("click",{dialog:a},function(b){a.close()})},onhide:function(a){a.getModal().removeClass("right left top bottom").addClass("closing")},onhidden:function(a){j.notes.remove(a),a.getModal().removeClass("closing"),"function"==typeof d.onhidden&&d.onhidden.call(a,a)}}),d.timeout,d.icons).open()},j.processing.defaultOptions={backdrop:!1,position:"right top",size:{width:"auto",minWidth:"20em",maxWidth:"40em"},timeout:{success:null,error:null,warning:null,default:3500},icons:{processing:null,warning:"fa fa-exclamation-triangle",error:"fa fa-bug",success:"fa fa-check-circle"},nl2br:!1,message:"Processing..."},j.processing.configDefaultOptions=function(b){j.processing.defaultOptions=a.extend({},j.processing.defaultOptions,b,{timeout:a.extend({},j.processing.defaultOptions.timeout,b.timeout)})},j.info=function(b,c){var d={},e=j.info.defaultOptions;return d="object"==typeof b&&b.constructor==={}.constructor?a.extend({},e,b):"string"==typeof b?a.extend({},e,{message:b}):a.extend({},e),a.extend(d,"function"==typeof c?{onhidden:c}:{}),new j({type:j.TYPE_NOTE_INFO,size:d.size,backdrop:d.backdrop,position:d.position,nl2br:d.nl2br,message:function(){return'<div class="alert alert-info" role="alert"><button type="button" class="close" aria-label="Close">&times;</button><i class="'+d.icon+'"></i><p>'+d.message+"</p></div>"}(),defdom:!1,data:{timeout:d.timeout},onrealized:function(a){j.notes.push(a)},onshow:function(a){a.getModalDialog().find('[role="alert"]').find("button.close").one("click",{dialog:a},function(b){a.close()})},onshown:function(a){var b=a.getData("timeout");if(b&&b>0){var c,d=a.getModalDialog(),e=function(){c&&clearTimeout(c),c=null},f=function(){e(),c=setTimeout(function(){a.close()},b)};f(),d.on("mouseenter",{call:e},function(a){a.data.call()}).on("mouseleave",{call:f},function(a){a.data.call()})}},onhide:function(a){a.getModal().removeClass("right left top bottom").addClass("closing")},onhidden:function(a){j.notes.remove(a),a.getModal().removeClass("closing"),"function"==typeof d.onhidden&&d.onhidden.call(a,a)}}).open()},j.info.defaultOptions={backdrop:!1,position:"right top",size:{width:"auto",minWidth:"20em",maxWidth:"40em"},timeout:3500,icon:"fa fa-info-circle",nl2br:!1,message:"Info."},j.info.configDefaultOptions=function(b){j.info.defaultOptions=a.extend({},j.info.defaultOptions,b)},j.warning=function(b,c){var d={},e=j.warning.defaultOptions;return d="object"==typeof b&&b.constructor==={}.constructor?a.extend({},e,b):"string"==typeof b?a.extend({},e,{message:b}):a.extend({},e),a.extend(d,"function"==typeof c?{onhidden:c}:{}),new j({type:j.TYPE_NOTE_WARNING,size:d.size,backdrop:d.backdrop,position:d.position,nl2br:d.nl2br,message:function(){return'<div class="alert alert-warning" role="alert"><button type="button" class="close" aria-label="Close">&times;</button><i class="'+d.icon+'"></i><p>'+d.message+"</p></div>"}(),defdom:!1,data:{timeout:d.timeout},onrealized:function(a){j.notes.push(a)},onshow:function(a){a.getModalDialog().find('[role="alert"]').find("button.close").one("click",{dialog:a},function(b){a.close()})},onshown:function(a){var b=a.getData("timeout");if(b&&b>0){var c,d=a.getModalDialog(),e=function(){c&&clearTimeout(c),c=null},f=function(){e(),c=setTimeout(function(){a.close()},b)};f(),d.on("mouseenter",{call:e},function(a){a.data.call()}).on("mouseleave",{call:f},function(a){a.data.call()})}},onhide:function(a){a.getModal().removeClass("right left top bottom").addClass("closing")},onhidden:function(a){j.notes.remove(a),a.getModal().removeClass("closing"),"function"==typeof d.onhidden&&d.onhidden.call(a,a)}}).open()},j.warning.defaultOptions={backdrop:!1,position:"right top",size:{width:"auto",minWidth:"20em",maxWidth:"40em"},timeout:3500,icon:"fa fa-exclamation-triangle",nl2br:!1,message:"Warning!"},j.warning.configDefaultOptions=function(b){j.warning.defaultOptions=a.extend({},j.warning.defaultOptions,b)},j.error=function(b,c){var d={},e=j.error.defaultOptions;return d="object"==typeof b&&b.constructor==={}.constructor?a.extend({},e,b):"string"==typeof b?a.extend({},e,{message:b}):a.extend({},e),a.extend(d,"function"==typeof c?{onhidden:c}:{}),new j({type:j.TYPE_NOTE_ERROR,size:d.size,backdrop:d.backdrop,position:d.position,nl2br:d.nl2br,message:function(){return'<div class="alert alert-danger" role="alert"><button type="button" class="close" aria-label="Close">&times;</button><i class="'+d.icon+'"></i><p>'+d.message+"</p></div>"}(),defdom:!1,data:{timeout:d.timeout},onrealized:function(a){j.notes.push(a)},onshow:function(a){a.getModalDialog().find('[role="alert"]').find("button.close").one("click",{dialog:a},function(b){a.close()})},onshown:function(a){var b=a.getData("timeout");if(b&&b>0){var c,d=a.getModalDialog(),e=function(){c&&clearTimeout(c),c=null},f=function(){e(),c=setTimeout(function(){a.close()},b)};f(),d.on("mouseenter",{call:e},function(a){a.data.call()}).on("mouseleave",{call:f},function(a){a.data.call()})}},onhide:function(a){a.getModal().removeClass("right left top bottom").addClass("closing")},onhidden:function(a){j.notes.remove(a),a.getModal().removeClass("closing"),"function"==typeof d.onhidden&&d.onhidden.call(a,a)}}).open()},j.error.defaultOptions={backdrop:!1,position:"right top",size:{width:"auto",minWidth:"20em",maxWidth:"40em"},timeout:3500,icon:"fa fa-bug",nl2br:!1,message:"Error!"},j.error.configDefaultOptions=function(b){j.error.defaultOptions=a.extend({},j.error.defaultOptions,b)},j.success=function(b,c){var d={},e=j.success.defaultOptions;return d="object"==typeof b&&b.constructor==={}.constructor?a.extend({},e,b):"string"==typeof b?a.extend({},e,{message:b}):a.extend({},e),a.extend(d,"function"==typeof c?{onhidden:c}:{}),new j({type:j.TYPE_NOTE_SUCCESS,size:d.size,backdrop:d.backdrop,position:d.position,nl2br:d.nl2br,message:function(){return'<div class="alert alert-success" role="alert"><button type="button" class="close" aria-label="Close">&times;</button><i class="'+d.icon+'"></i><p>'+d.message+"</p></div>"}(),defdom:!1,data:{timeout:d.timeout},onrealized:function(a){j.notes.push(a)},onshow:function(a){a.getModalDialog().find('[role="alert"]').find("button.close").one("click",{dialog:a},function(b){a.close()})},onshown:function(a){var b=a.getData("timeout");if(b&&b>0){var c,d=a.getModalDialog(),e=function(){c&&clearTimeout(c),c=null},f=function(){e(),c=setTimeout(function(){a.close()},b)};d.on("mouseenter",{call:e},function(a){a.data.call()}).on("mouseleave",{call:f},function(a){a.data.call()}),f()}},onhide:function(a){a.getModal().removeClass("right left top bottom").addClass("closing")},onhidden:function(a){j.notes.remove(a),a.getModal().removeClass("closing"),"function"==typeof d.onhidden&&d.onhidden.call(a,a)}}).open()},j.success.defaultOptions={backdrop:!1,position:"right top",size:{width:"auto",minWidth:"20em",maxWidth:"40em"},timeout:3500,icon:"fa fa-check-circle",nl2br:!1,message:"Success!"},j.success.configDefaultOptions=function(b){j.success.defaultOptions=a.extend({},j.success.defaultOptions,b)},j});