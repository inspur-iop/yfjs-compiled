define("echarts2/chart/radar",["require","./base","zrender2/shape/Polygon","../component/polar","../config","../util/ecData","zrender2/tool/util","zrender2/tool/color","../util/accMath","../chart"],function(a){function b(a,b,d,e,f){c.call(this,a,b,d,e,f),this.refresh(e)}var c=a("./base"),d=a("zrender2/shape/Polygon");a("../component/polar");var e=a("../config");e.radar={zlevel:0,z:2,clickable:!0,legendHoverLink:!0,polarIndex:0,itemStyle:{normal:{label:{show:!1},lineStyle:{width:2,type:"solid"}},emphasis:{label:{show:!1}}},symbolSize:2};var f=a("../util/ecData"),g=a("zrender2/tool/util"),h=a("zrender2/tool/color");return b.prototype={type:e.CHART_TYPE_RADAR,_buildShape:function(){this.selectedMap={},this._symbol=this.option.symbolList,this._queryTarget,this._dropBoxList=[],this._radarDataCounter=0;for(var a,b=this.series,c=this.component.legend,d=0,f=b.length;d<f;d++)b[d].type===e.CHART_TYPE_RADAR&&(this.serie=this.reformOption(b[d]),this.legendHoverLink=b[d].legendHoverLink||this.legendHoverLink,a=this.serie.name||"",this.selectedMap[a]=!c||c.isSelected(a),this.selectedMap[a]&&(this._queryTarget=[this.serie,this.option],this.deepQuery(this._queryTarget,"calculable")&&this._addDropBox(d),this._buildSingleRadar(d),this.buildMark(d)));this.addShapeList()},_buildSingleRadar:function(a){for(var b,c,d,e,f=this.component.legend,g=this.serie.data,h=this.deepQuery(this._queryTarget,"calculable"),i=0;i<g.length;i++)d=g[i].name||"",this.selectedMap[d]=!f||f.isSelected(d),this.selectedMap[d]&&(f?(c=f.getColor(d),b=f.getItemShape(d),b&&(b.style.brushType=this.deepQuery([g[i],this.serie],"itemStyle.normal.areaStyle")?"both":"stroke",f.setItemShape(d,b))):c=this.zr.getColor(i),e=this._getPointList(this.serie.polarIndex,g[i]),this._addSymbol(e,c,i,a,this.serie.polarIndex),this._addDataShape(e,c,g[i],a,i,h),this._radarDataCounter++)},_getPointList:function(a,b){for(var c,d,e=[],f=this.component.polar,g=0,h=b.value.length;g<h;g++)d=this.getDataFromOption(b.value[g]),c="-"!=d&&f.getVector(a,g,d),c&&e.push(c);return e},_addSymbol:function(a,b,c,d,e){for(var g,h=this.series,i=this.component.polar,j=0,k=a.length;j<k;j++)g=this.getSymbolShape(this.deepMerge([h[d].data[c],h[d]]),d,h[d].data[c].value[j],j,i.getIndicatorText(e,j),a[j][0],a[j][1],this._symbol[this._radarDataCounter%this._symbol.length],b,"#fff","vertical"),g.zlevel=this.getZlevelBase(),g.z=this.getZBase()+1,f.set(g,"data",h[d].data[c]),f.set(g,"value",h[d].data[c].value),f.set(g,"dataIndex",c),f.set(g,"special",j),this.shapeList.push(g)},_addDataShape:function(a,b,c,e,g,i){var j=this.series,k=[c,this.serie],l=this.getItemStyleColor(this.deepQuery(k,"itemStyle.normal.color"),e,g,c),m=this.deepQuery(k,"itemStyle.normal.lineStyle.width"),n=this.deepQuery(k,"itemStyle.normal.lineStyle.type"),o=this.deepQuery(k,"itemStyle.normal.areaStyle.color"),p=this.deepQuery(k,"itemStyle.normal.areaStyle"),q={zlevel:this.getZlevelBase(),z:this.getZBase(),style:{pointList:a,brushType:p?"both":"stroke",color:o||l||("string"==typeof b?h.alpha(b,.5):b),strokeColor:l||b,lineWidth:m,lineType:n},highlightStyle:{brushType:this.deepQuery(k,"itemStyle.emphasis.areaStyle")||p?"both":"stroke",color:this.deepQuery(k,"itemStyle.emphasis.areaStyle.color")||o||l||("string"==typeof b?h.alpha(b,.5):b),strokeColor:this.getItemStyleColor(this.deepQuery(k,"itemStyle.emphasis.color"),e,g,c)||l||b,lineWidth:this.deepQuery(k,"itemStyle.emphasis.lineStyle.width")||m,lineType:this.deepQuery(k,"itemStyle.emphasis.lineStyle.type")||n}};f.pack(q,j[e],e,c,g,c.name,this.component.polar.getIndicator(j[e].polarIndex)),i&&(q.draggable=!0,this.setCalculable(q)),q=new d(q),this.shapeList.push(q)},_addDropBox:function(a){var b=this.series,c=this.deepQuery(this._queryTarget,"polarIndex");if(!this._dropBoxList[c]){var d=this.component.polar.getDropBox(c);d.zlevel=this.getZlevelBase(),d.z=this.getZBase(),this.setCalculable(d),f.pack(d,b,a,void 0,-1),this.shapeList.push(d),this._dropBoxList[c]=!0}},ondragend:function(a,b){var c=this.series;if(this.isDragend&&a.target){var d=a.target,e=f.get(d,"seriesIndex"),g=f.get(d,"dataIndex");this.component.legend&&this.component.legend.del(c[e].data[g].name),c[e].data.splice(g,1),b.dragOut=!0,b.needRefresh=!0,this.isDragend=!1}},ondrop:function(b,c){var d=this.series;if(this.isDrop&&b.target){var e,g,h=b.target,i=b.dragged,j=f.get(h,"seriesIndex"),k=f.get(h,"dataIndex"),l=this.component.legend;if(k===-1)e={value:f.get(i,"value"),name:f.get(i,"name")},d[j].data.push(e),l&&l.add(e.name,i.style.color||i.style.strokeColor);else{var m=a("../util/accMath");e=d[j].data[k],l&&l.del(e.name),e.name+=this.option.nameConnector+f.get(i,"name"),g=f.get(i,"value");for(var n=0;n<g.length;n++)e.value[n]=m.accAdd(e.value[n],g[n]);l&&l.add(e.name,i.style.color||i.style.strokeColor)}c.dragIn=c.dragIn||!0,this.isDrop=!1}},refresh:function(a){a&&(this.option=a,this.series=a.series),this.backupShapeList(),this._buildShape()}},g.inherits(b,c),a("../chart").define("radar",b),b}),define("echarts2/component/polar",["require","./base","zrender2/shape/Text","zrender2/shape/Line","zrender2/shape/Polygon","zrender2/shape/Circle","zrender2/shape/Ring","../config","zrender2/tool/util","../util/coordinates","../util/accMath","../util/smartSteps","../component"],function(a){function b(a,b,d,e,f){c.call(this,a,b,d,e,f),this.refresh(e)}var c=a("./base"),d=a("zrender2/shape/Text"),e=a("zrender2/shape/Line"),f=a("zrender2/shape/Polygon"),g=a("zrender2/shape/Circle"),h=a("zrender2/shape/Ring"),i=a("../config");i.polar={zlevel:0,z:0,center:["50%","50%"],radius:"75%",startAngle:90,boundaryGap:[0,0],splitNumber:5,name:{show:!0,textStyle:{color:"#333"}},axisLine:{show:!0,lineStyle:{color:"#ccc",width:1,type:"solid"}},axisLabel:{show:!1,textStyle:{color:"#333"}},splitArea:{show:!0,areaStyle:{color:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]}},splitLine:{show:!0,lineStyle:{width:1,color:"#ccc"}},type:"polygon"};var j=a("zrender2/tool/util"),k=a("../util/coordinates");return b.prototype={type:i.COMPONENT_TYPE_POLAR,_buildShape:function(){for(var a=0;a<this.polar.length;a++)this._index=a,this.reformOption(this.polar[a]),this._queryTarget=[this.polar[a],this.option],this._createVector(a),this._buildSpiderWeb(a),this._buildText(a),this._adjustIndicatorValue(a),this._addAxisLabel(a);for(var a=0;a<this.shapeList.length;a++)this.zr.addShape(this.shapeList[a])},_createVector:function(a){for(var b,c=this.polar[a],d=this.deepQuery(this._queryTarget,"indicator"),e=d.length,f=c.startAngle,g=2*Math.PI/e,h=this._getRadius(),i=c.__ecIndicator=[],j=0;j<e;j++)b=k.polar2cartesian(h,f*Math.PI/180+g*j),i.push({vector:[b[1],-b[0]]})},_getRadius:function(){var a=this.polar[this._index];return this.parsePercent(a.radius,Math.min(this.zr.getWidth(),this.zr.getHeight())/2)},_buildSpiderWeb:function(a){var b=this.polar[a],c=b.__ecIndicator,d=b.splitArea,e=b.splitLine,f=this.getCenter(a),g=b.splitNumber,h=e.lineStyle.color,i=e.lineStyle.width,j=e.show,k=this.deepQuery(this._queryTarget,"axisLine");this._addArea(c,g,f,d,h,i,j),k.show&&this._addLine(c,f,k)},_addAxisLabel:function(b){for(var c,e,f,g,e,h,i,k,l,m,n=a("../util/accMath"),o=this.polar[b],p=this.deepQuery(this._queryTarget,"indicator"),q=o.__ecIndicator,r=this.deepQuery(this._queryTarget,"splitNumber"),s=this.getCenter(b),t=0;t<p.length;t++)if(c=this.deepQuery([p[t],o,this.option],"axisLabel"),c.show){var u=this.deepQuery([c,o,this.option],"textStyle"),v=this.deepQuery([c,o],"formatter");if(f={},f.textFont=this.getFont(u),f.color=u.color,f=j.merge(f,c),f.lineWidth=f.width,e=q[t].vector,h=q[t].value,k=t/p.length*2*Math.PI,l=c.offset||10,m=c.interval||0,!h)return;for(var w=1;w<=r;w+=m+1)g=j.merge({},f),i=n.accAdd(h.min,n.accMul(h.step,w)),i="function"==typeof v?v(i):"string"==typeof v?v.replace("{a}","{a0}").replace("{a0}",i):this.numAddCommas(i),g.text=i,g.x=w*e[0]/r+Math.cos(k)*l+s[0],g.y=w*e[1]/r+Math.sin(k)*l+s[1],this.shapeList.push(new d({zlevel:this.getZlevelBase(),z:this.getZBase(),style:g,draggable:!1,hoverable:!1}))}},_buildText:function(a){for(var b,c,e,f,g,h,i,j=this.polar[a],k=j.__ecIndicator,l=this.deepQuery(this._queryTarget,"indicator"),m=this.getCenter(a),n=0,o=0,p=0;p<l.length;p++)f=this.deepQuery([l[p],j,this.option],"name"),f.show&&(i=this.deepQuery([f,j,this.option],"textStyle"),c={},c.textFont=this.getFont(i),c.color=i.color,"function"==typeof f.formatter?c.text=f.formatter.call(this.myChart,l[p].text,p):"string"==typeof f.formatter?c.text=f.formatter.replace("{value}",l[p].text):c.text=l[p].text,k[p].text=c.text,b=k[p].vector,e=Math.round(b[0])>0?"left":Math.round(b[0])<0?"right":"center",null==f.margin?b=this._mapVector(b,m,1.1):(h=f.margin,n=b[0]>0?h:-h,o=b[1]>0?h:-h,n=0===b[0]?0:n,o=0===b[1]?0:o,b=this._mapVector(b,m,1)),c.textAlign=e,c.x=b[0]+n,c.y=b[1]+o,g=f.rotate?[f.rotate/180*Math.PI,b[0],b[1]]:[0,0,0],this.shapeList.push(new d({zlevel:this.getZlevelBase(),z:this.getZBase(),style:c,draggable:!1,hoverable:!1,rotation:g})))},getIndicatorText:function(a,b){return this.polar[a]&&this.polar[a].__ecIndicator[b]&&this.polar[a].__ecIndicator[b].text},getDropBox:function(a){var b,c,a=a||0,d=this.polar[a],e=this.getCenter(a),f=d.__ecIndicator,g=f.length,h=[],i=d.type;if("polygon"==i){for(var j=0;j<g;j++)b=f[j].vector,h.push(this._mapVector(b,e,1.2));c=this._getShape(h,"fill","rgba(0,0,0,0)","",1)}else"circle"==i&&(c=this._getCircle("",1,1.2,e,"fill","rgba(0,0,0,0)"));return c},_addArea:function(a,b,c,d,e,f,g){for(var h,i,j,k,l=this.deepQuery(this._queryTarget,"type"),m=0;m<b;m++)i=(b-m)/b,g&&("polygon"==l?(k=this._getPointList(a,i,c),h=this._getShape(k,"stroke","",e,f)):"circle"==l&&(h=this._getCircle(e,f,i,c,"stroke")),this.shapeList.push(h)),d.show&&(j=(b-m-1)/b,this._addSplitArea(a,d,i,j,c,m))},_getCircle:function(a,b,c,d,e,f){var h=this._getRadius();return new g({zlevel:this.getZlevelBase(),z:this.getZBase(),style:{x:d[0],y:d[1],r:h*c,brushType:e,strokeColor:a,lineWidth:b,color:f},hoverable:!1,draggable:!1})},_getRing:function(a,b,c,d){var e=this._getRadius();return new h({zlevel:this.getZlevelBase(),z:this.getZBase(),style:{x:d[0],y:d[1],r:b*e,r0:c*e,color:a,brushType:"fill"},hoverable:!1,draggable:!1})},_getPointList:function(a,b,c){for(var d,e=[],f=a.length,g=0;g<f;g++)d=a[g].vector,e.push(this._mapVector(d,c,b));return e},_getShape:function(a,b,c,d,e){return new f({zlevel:this.getZlevelBase(),z:this.getZBase(),style:{pointList:a,brushType:b,color:c,strokeColor:d,lineWidth:e},hoverable:!1,draggable:!1})},_addSplitArea:function(a,b,c,d,e,f){var g,h,i,j,k,l=a.length,m=b.areaStyle.color,n=[],l=a.length,o=this.deepQuery(this._queryTarget,"type");if("string"==typeof m&&(m=[m]),h=m.length,g=m[f%h],"polygon"==o)for(var p=0;p<l;p++)n=[],i=a[p].vector,j=a[(p+1)%l].vector,n.push(this._mapVector(i,e,c)),n.push(this._mapVector(i,e,d)),n.push(this._mapVector(j,e,d)),n.push(this._mapVector(j,e,c)),k=this._getShape(n,"fill",g,"",1),this.shapeList.push(k);else"circle"==o&&(k=this._getRing(g,c,d,e),this.shapeList.push(k))},_mapVector:function(a,b,c){return[a[0]*c+b[0],a[1]*c+b[1]]},getCenter:function(a){var a=a||0;return this.parseCenter(this.zr,this.polar[a].center)},_addLine:function(a,b,c){for(var d,e,f=a.length,g=c.lineStyle,h=g.color,i=g.width,j=g.type,k=0;k<f;k++)e=a[k].vector,d=this._getLine(b[0],b[1],e[0]+b[0],e[1]+b[1],h,i,j),this.shapeList.push(d)},_getLine:function(a,b,c,d,f,g,h){return new e({zlevel:this.getZlevelBase(),z:this.getZBase(),style:{xStart:a,yStart:b,xEnd:c,yEnd:d,strokeColor:f,lineWidth:g,lineType:h},hoverable:!1})},_adjustIndicatorValue:function(b){for(var c,d,e,f=this.polar[b],g=this.deepQuery(this._queryTarget,"indicator"),h=g.length,i=f.__ecIndicator,j=this._getSeriesData(b),k=f.boundaryGap,l=f.splitNumber,m=f.scale,n=a("../util/smartSteps"),o=0;o<h;o++){if("number"==typeof g[o].max)c=g[o].max,d=g[o].min||0,e={max:c,min:d};else{var p=this._findValue(j,o,l,k);d=p.min,c=p.max}!m&&d>=0&&c>=0&&(d=0),!m&&d<=0&&c<=0&&(c=0);var q=n(d,c,l,e);i[o].value={min:q.min,max:q.max,step:q.step}}},_getSeriesData:function(a){for(var b,c,d,e=[],f=this.component.legend,g=0;g<this.series.length;g++)if(b=this.series[g],b.type==i.CHART_TYPE_RADAR){c=b.data||[];for(var h=0;h<c.length;h++)d=this.deepQuery([c[h],b,this.option],"polarIndex")||0,d!=a||f&&!f.isSelected(c[h].name)||e.push(c[h])}return e},_findValue:function(a,b,c,d){function e(a){(a>f||void 0===f)&&(f=a),(a<g||void 0===g)&&(g=a)}var f,g,h;if(a&&0!==a.length){if(1==a.length&&(g=0),1!=a.length)for(var i=0;i<a.length;i++)e(this.getDataFromOption(a[i].value[b]));else{h=a[0];for(var i=0;i<h.value.length;i++)e(this.getDataFromOption(h.value[i]))}var j=Math.abs(f-g);return g-=Math.abs(j*d[0]),f+=Math.abs(j*d[1]),g===f&&(0===f?f=1:f>0?g=f/c:f/=c),{max:f,min:g}}},getVector:function(a,b,c){a=a||0,b=b||0;var d=this.polar[a].__ecIndicator;if(!(b>=d.length)){var e,f=this.polar[a].__ecIndicator[b],g=this.getCenter(a),h=f.vector,i=f.value.max,j=f.value.min;if("undefined"==typeof c)return g;switch(c){case"min":c=j;break;case"max":c=i;break;case"center":c=(i+j)/2}return e=i!=j?(c-j)/(i-j):.5,this._mapVector(h,g,e)}},isInside:function(a){var b=this.getNearestIndex(a);return b?b.polarIndex:-1},getNearestIndex:function(a){for(var b,c,d,e,f,g,h,i,j,l=0;l<this.polar.length;l++){if(b=this.polar[l],c=this.getCenter(l),a[0]==c[0]&&a[1]==c[1])return{polarIndex:l,valueIndex:0};if(d=this._getRadius(),f=b.startAngle,g=b.indicator,h=g.length,i=2*Math.PI/h,e=k.cartesian2polar(a[0]-c[0],c[1]-a[1]),a[0]-c[0]<0&&(e[1]+=Math.PI),e[1]<0&&(e[1]+=2*Math.PI),j=e[1]-f/180*Math.PI+2*Math.PI,Math.abs(Math.cos(j%(i/2)))*d>e[0])return{polarIndex:l,valueIndex:Math.floor((j+i/2)/i)%h}}},getIndicator:function(a){var a=a||0;return this.polar[a].indicator},refresh:function(a){a&&(this.option=a,this.polar=this.option.polar,this.series=this.option.series),this.clear(),this._buildShape()}},j.inherits(b,c),a("../component").define("polar",b),b}),define("echarts2/util/coordinates",["require","zrender2/tool/math"],function(a){function b(a,b){return[a*d.sin(b),a*d.cos(b)]}function c(a,b){return[Math.sqrt(a*a+b*b),Math.atan(b/a)]}var d=a("zrender2/tool/math");return{polar2cartesian:b,cartesian2polar:c}});